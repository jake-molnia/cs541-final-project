❯ uv run model_trainin\ g.py
2025-04-30 00:07:52,349 - INFO - GPU not available, using CPU instead
2025-04-30 00:07:52,356 - INFO - Accelerator initialized
2025-04-30 00:07:52,356 - INFO - Loading preprocessed dataset
2025-04-30 00:07:52,423 - INFO - Loaded dataset with 11923 rows
2025-04-30 00:07:52,423 - INFO - Validating text column
2025-04-30 00:07:52,423 - INFO - Data columns: ['subject', 'body', 'answer', 'type', 'queue', 'priority', 'language', 'tag_1', 'tag_2', 'tag_3', 'tag_4', 'tag_5', 'tag_6', 'tag_7', 'tag_8', 'text', 'sentiment_predicted', 'emotion', 'emotion_numeric']
2025-04-30 00:07:52,423 - INFO - Sample text: Customer Support Inquiry Seeking information on digital strategies that can aid in brand growth and ...
2025-04-30 00:07:52,424 - INFO - Loading DistilBERT tokenizer
2025-04-30 00:07:52,646 - INFO - Setting up emotion mappings
2025-04-30 00:07:52,646 - INFO - Preparing labels for training
2025-04-30 00:07:52,646 - INFO - Unique values in emotion column: ['neutral' 'negative' 'positive']
2025-04-30 00:07:52,648 - INFO - Label distribution for three-class model: {1: 11249, 2: 484, 0: 190}
2025-04-30 00:07:52,649 - INFO - Label range for gradient model: min=-1.0, max=1.0
2025-04-30 00:07:52,649 - INFO - Initializing DistilBERT models
Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-04-30 00:07:53,328 - INFO - Defining tokenization function
2025-04-30 00:07:53,329 - INFO - Converting to Hugging Face Dataset
2025-04-30 00:07:53,344 - INFO - Tokenizing datasets
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11923/11923 [00:05<00:00, 2282.42 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11923/11923 [00:05<00:00, 2256.91 examples/s]
2025-04-30 00:08:04,029 - INFO - Splitting datasets into train and test sets
2025-04-30 00:08:04,033 - INFO - Train dataset three features: {'text': Value(dtype='string', id=None), 'label_three': Value(dtype='int64', id=None), 'input_ids': Sequence(feature=Value(dtype='int32', id=None), length=-1, id=None), 'attention_mask': Sequence(feature=Value(dtype='int8', id=None), length=-1, id=None), 'labels': Value(dtype='int64', id=None)}
2025-04-30 00:08:04,034 - INFO - Train dataset grad features: {'text': Value(dtype='string', id=None), 'label_grad': Value(dtype='float64', id=None), 'input_ids': Sequence(feature=Value(dtype='int32', id=None), length=-1, id=None), 'attention_mask': Sequence(feature=Value(dtype='int8', id=None), length=-1, id=None), 'labels': Value(dtype='float64', id=None)}
2025-04-30 00:08:04,034 - INFO - Setting up training arguments
2025-04-30 00:08:04,034 - INFO - Initializing model trainers
2025-04-30 00:08:04,360 - INFO - Fine-tuning Three-class Sentiment model...
  0%|                                                                                                                                                     | 0/3579 [00:00<?, ?it/s]/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.8112, 'grad_norm': 3.303591728210449, 'learning_rate': 1.9949706621961446e-05, 'epoch': 0.01}
{'loss': 0.3036, 'grad_norm': 1.911577820777893, 'learning_rate': 1.989382509080749e-05, 'epoch': 0.02}
{'loss': 0.4315, 'grad_norm': 5.465627670288086, 'learning_rate': 1.9837943559653536e-05, 'epoch': 0.03}
{'loss': 0.1468, 'grad_norm': 0.6178402900695801, 'learning_rate': 1.9782062028499583e-05, 'epoch': 0.03}
{'loss': 0.246, 'grad_norm': 0.4488822817802429, 'learning_rate': 1.9726180497345627e-05, 'epoch': 0.04}
{'loss': 0.4228, 'grad_norm': 0.9508875012397766, 'learning_rate': 1.9670298966191674e-05, 'epoch': 0.05}
{'loss': 0.2227, 'grad_norm': 0.6871556639671326, 'learning_rate': 1.9614417435037724e-05, 'epoch': 0.06}
{'loss': 0.2812, 'grad_norm': 0.4334469437599182, 'learning_rate': 1.9558535903883767e-05, 'epoch': 0.07}
{'loss': 0.0775, 'grad_norm': 0.26341912150382996, 'learning_rate': 1.9502654372729814e-05, 'epoch': 0.08}
{'loss': 0.3583, 'grad_norm': 0.2632635831832886, 'learning_rate': 1.944677284157586e-05, 'epoch': 0.08}
{'loss': 0.1804, 'grad_norm': 0.4187924563884735, 'learning_rate': 1.9390891310421908e-05, 'epoch': 0.09}
{'loss': 0.2216, 'grad_norm': 0.6233371496200562, 'learning_rate': 1.933500977926795e-05, 'epoch': 0.1}
{'loss': 0.1798, 'grad_norm': 0.3235982060432434, 'learning_rate': 1.9279128248114002e-05, 'epoch': 0.11}
{'loss': 0.3266, 'grad_norm': 2.6057918071746826, 'learning_rate': 1.9223246716960045e-05, 'epoch': 0.12}
{'loss': 0.1284, 'grad_norm': 0.6415849924087524, 'learning_rate': 1.9167365185806092e-05, 'epoch': 0.13}
{'loss': 0.204, 'grad_norm': 3.1665797233581543, 'learning_rate': 1.911148365465214e-05, 'epoch': 0.13}
{'loss': 0.5099, 'grad_norm': 1.187699794769287, 'learning_rate': 1.9055602123498186e-05, 'epoch': 0.14}
{'loss': 0.1696, 'grad_norm': 0.8925588130950928, 'learning_rate': 1.899972059234423e-05, 'epoch': 0.15}
{'loss': 0.1825, 'grad_norm': 0.29586392641067505, 'learning_rate': 1.894383906119028e-05, 'epoch': 0.16}
{'loss': 0.2699, 'grad_norm': 3.758300304412842, 'learning_rate': 1.8887957530036323e-05, 'epoch': 0.17}
{'loss': 0.1802, 'grad_norm': 4.955800533294678, 'learning_rate': 1.883207599888237e-05, 'epoch': 0.18}
{'loss': 0.1528, 'grad_norm': 1.9400120973587036, 'learning_rate': 1.8776194467728417e-05, 'epoch': 0.18}
{'loss': 0.2126, 'grad_norm': 1.355780839920044, 'learning_rate': 1.8720312936574464e-05, 'epoch': 0.19}
{'loss': 0.2238, 'grad_norm': 0.7032036185264587, 'learning_rate': 1.866443140542051e-05, 'epoch': 0.2}
{'loss': 0.202, 'grad_norm': 0.11804943531751633, 'learning_rate': 1.8608549874266558e-05, 'epoch': 0.21}
{'loss': 0.2098, 'grad_norm': 0.41859862208366394, 'learning_rate': 1.85526683431126e-05, 'epoch': 0.22}
{'loss': 0.234, 'grad_norm': 1.9307814836502075, 'learning_rate': 1.849678681195865e-05, 'epoch': 0.23}
{'loss': 0.0852, 'grad_norm': 1.5386883020401, 'learning_rate': 1.8440905280804695e-05, 'epoch': 0.23}
{'loss': 0.0806, 'grad_norm': 0.10761526226997375, 'learning_rate': 1.8385023749650742e-05, 'epoch': 0.24}
{'loss': 0.2636, 'grad_norm': 9.21707820892334, 'learning_rate': 1.832914221849679e-05, 'epoch': 0.25}
{'loss': 0.2058, 'grad_norm': 3.37473201751709, 'learning_rate': 1.8273260687342836e-05, 'epoch': 0.26}
{'loss': 0.2892, 'grad_norm': 0.7370845675468445, 'learning_rate': 1.8217379156188883e-05, 'epoch': 0.27}
{'loss': 0.2576, 'grad_norm': 0.2563939690589905, 'learning_rate': 1.8161497625034926e-05, 'epoch': 0.28}
{'loss': 0.3196, 'grad_norm': 0.6981490254402161, 'learning_rate': 1.8105616093880973e-05, 'epoch': 0.28}
{'loss': 0.2782, 'grad_norm': 4.629701614379883, 'learning_rate': 1.804973456272702e-05, 'epoch': 0.29}
{'loss': 0.1911, 'grad_norm': 0.318399041891098, 'learning_rate': 1.7993853031573067e-05, 'epoch': 0.3}
{'loss': 0.2446, 'grad_norm': 8.384342193603516, 'learning_rate': 1.7937971500419114e-05, 'epoch': 0.31}
{'loss': 0.2573, 'grad_norm': 0.1949651539325714, 'learning_rate': 1.788208996926516e-05, 'epoch': 0.32}
{'loss': 0.2409, 'grad_norm': 4.178644180297852, 'learning_rate': 1.7826208438111204e-05, 'epoch': 0.33}
{'loss': 0.1107, 'grad_norm': 0.26118049025535583, 'learning_rate': 1.777032690695725e-05, 'epoch': 0.34}
{'loss': 0.3489, 'grad_norm': 4.128123760223389, 'learning_rate': 1.7714445375803298e-05, 'epoch': 0.34}
{'loss': 0.358, 'grad_norm': 1.263008713722229, 'learning_rate': 1.7658563844649345e-05, 'epoch': 0.35}
{'loss': 0.1738, 'grad_norm': 0.5351369976997375, 'learning_rate': 1.7602682313495392e-05, 'epoch': 0.36}
{'loss': 0.1747, 'grad_norm': 0.2526208162307739, 'learning_rate': 1.754680078234144e-05, 'epoch': 0.37}
{'loss': 0.2473, 'grad_norm': 4.068845748901367, 'learning_rate': 1.7490919251187482e-05, 'epoch': 0.38}
{'loss': 0.1994, 'grad_norm': 6.710036277770996, 'learning_rate': 1.743503772003353e-05, 'epoch': 0.39}
{'loss': 0.18, 'grad_norm': 12.602743148803711, 'learning_rate': 1.7379156188879576e-05, 'epoch': 0.39}
{'loss': 0.1665, 'grad_norm': 0.37372010946273804, 'learning_rate': 1.7323274657725623e-05, 'epoch': 0.4}
{'loss': 0.3162, 'grad_norm': 4.6700849533081055, 'learning_rate': 1.726739312657167e-05, 'epoch': 0.41}
{'loss': 0.1202, 'grad_norm': 0.5153716802597046, 'learning_rate': 1.7211511595417717e-05, 'epoch': 0.42}
{'loss': 0.1733, 'grad_norm': 4.602077007293701, 'learning_rate': 1.715563006426376e-05, 'epoch': 0.43}
{'loss': 0.2371, 'grad_norm': 6.876274585723877, 'learning_rate': 1.7099748533109807e-05, 'epoch': 0.44}
{'loss': 0.2804, 'grad_norm': 7.414859294891357, 'learning_rate': 1.7043867001955858e-05, 'epoch': 0.44}
{'loss': 0.2015, 'grad_norm': 6.473822593688965, 'learning_rate': 1.69879854708019e-05, 'epoch': 0.45}
{'loss': 0.2699, 'grad_norm': 6.483875751495361, 'learning_rate': 1.6932103939647948e-05, 'epoch': 0.46}
{'loss': 0.0963, 'grad_norm': 0.2788889408111572, 'learning_rate': 1.6876222408493995e-05, 'epoch': 0.47}
{'loss': 0.3108, 'grad_norm': 0.4241126775741577, 'learning_rate': 1.682034087734004e-05, 'epoch': 0.48}
{'loss': 0.1445, 'grad_norm': 3.6889445781707764, 'learning_rate': 1.6764459346186085e-05, 'epoch': 0.49}
{'loss': 0.1503, 'grad_norm': 0.15974795818328857, 'learning_rate': 1.6708577815032136e-05, 'epoch': 0.49}
{'loss': 0.2845, 'grad_norm': 5.920840263366699, 'learning_rate': 1.665269628387818e-05, 'epoch': 0.5}
{'loss': 0.2957, 'grad_norm': 1.0101948976516724, 'learning_rate': 1.6596814752724226e-05, 'epoch': 0.51}
{'loss': 0.1264, 'grad_norm': 0.3027610778808594, 'learning_rate': 1.6540933221570273e-05, 'epoch': 0.52}
{'loss': 0.1641, 'grad_norm': 0.25489988923072815, 'learning_rate': 1.648505169041632e-05, 'epoch': 0.53}
{'loss': 0.1591, 'grad_norm': 0.8145722150802612, 'learning_rate': 1.6429170159262363e-05, 'epoch': 0.54}
{'loss': 0.1772, 'grad_norm': 3.724900245666504, 'learning_rate': 1.6373288628108414e-05, 'epoch': 0.54}
{'loss': 0.1193, 'grad_norm': 0.2750760018825531, 'learning_rate': 1.6317407096954457e-05, 'epoch': 0.55}
{'loss': 0.2566, 'grad_norm': 5.362922191619873, 'learning_rate': 1.6261525565800504e-05, 'epoch': 0.56}
{'loss': 0.1858, 'grad_norm': 0.16430838406085968, 'learning_rate': 1.620564403464655e-05, 'epoch': 0.57}
{'loss': 0.0914, 'grad_norm': 0.11243370920419693, 'learning_rate': 1.6149762503492598e-05, 'epoch': 0.58}
{'loss': 0.2273, 'grad_norm': 6.28466272354126, 'learning_rate': 1.609388097233864e-05, 'epoch': 0.59}
{'loss': 0.1674, 'grad_norm': 0.06442496925592422, 'learning_rate': 1.6037999441184692e-05, 'epoch': 0.6}
{'loss': 0.0842, 'grad_norm': 0.0792403519153595, 'learning_rate': 1.5982117910030735e-05, 'epoch': 0.6}
{'loss': 0.2733, 'grad_norm': 0.11580707877874374, 'learning_rate': 1.5926236378876782e-05, 'epoch': 0.61}
{'loss': 0.285, 'grad_norm': 4.920197486877441, 'learning_rate': 1.587035484772283e-05, 'epoch': 0.62}
{'loss': 0.1608, 'grad_norm': 0.4898177683353424, 'learning_rate': 1.5814473316568876e-05, 'epoch': 0.63}
{'loss': 0.2109, 'grad_norm': 3.9691855907440186, 'learning_rate': 1.575859178541492e-05, 'epoch': 0.64}
{'loss': 0.3741, 'grad_norm': 0.5116686224937439, 'learning_rate': 1.570271025426097e-05, 'epoch': 0.65}
{'loss': 0.2661, 'grad_norm': 0.6917791962623596, 'learning_rate': 1.5646828723107013e-05, 'epoch': 0.65}
{'loss': 0.1793, 'grad_norm': 0.3915417790412903, 'learning_rate': 1.559094719195306e-05, 'epoch': 0.66}
{'loss': 0.3235, 'grad_norm': 6.590290069580078, 'learning_rate': 1.5535065660799107e-05, 'epoch': 0.67}
{'loss': 0.0764, 'grad_norm': 0.17433112859725952, 'learning_rate': 1.5479184129645154e-05, 'epoch': 0.68}
{'loss': 0.0082, 'grad_norm': 0.10073714703321457, 'learning_rate': 1.5423302598491197e-05, 'epoch': 0.69}
{'loss': 0.1293, 'grad_norm': 4.2733001708984375, 'learning_rate': 1.5367421067337248e-05, 'epoch': 0.7}
{'loss': 0.307, 'grad_norm': 0.09198634326457977, 'learning_rate': 1.5311539536183295e-05, 'epoch': 0.7}
{'loss': 0.3005, 'grad_norm': 8.133687973022461, 'learning_rate': 1.5255658005029338e-05, 'epoch': 0.71}
{'loss': 0.1326, 'grad_norm': 6.720369338989258, 'learning_rate': 1.5199776473875385e-05, 'epoch': 0.72}
{'loss': 0.1703, 'grad_norm': 0.1949443221092224, 'learning_rate': 1.514389494272143e-05, 'epoch': 0.73}
{'loss': 0.1811, 'grad_norm': 0.9855772852897644, 'learning_rate': 1.5088013411567479e-05, 'epoch': 0.74}
{'loss': 0.0971, 'grad_norm': 0.19120065867900848, 'learning_rate': 1.5032131880413526e-05, 'epoch': 0.75}
{'loss': 0.3302, 'grad_norm': 0.43034180998802185, 'learning_rate': 1.4976250349259571e-05, 'epoch': 0.75}
{'loss': 0.0746, 'grad_norm': 1.0503919124603271, 'learning_rate': 1.4920368818105618e-05, 'epoch': 0.76}
{'loss': 0.2509, 'grad_norm': 4.441824913024902, 'learning_rate': 1.4864487286951663e-05, 'epoch': 0.77}
{'loss': 0.2267, 'grad_norm': 1.3061801195144653, 'learning_rate': 1.480860575579771e-05, 'epoch': 0.78}
{'loss': 0.1693, 'grad_norm': 0.13996106386184692, 'learning_rate': 1.4752724224643757e-05, 'epoch': 0.79}
{'loss': 0.2429, 'grad_norm': 5.051066875457764, 'learning_rate': 1.4696842693489804e-05, 'epoch': 0.8}
{'loss': 0.1016, 'grad_norm': 1.2102106809616089, 'learning_rate': 1.4640961162335849e-05, 'epoch': 0.8}
{'loss': 0.4474, 'grad_norm': 0.6491930484771729, 'learning_rate': 1.4585079631181896e-05, 'epoch': 0.81}
{'loss': 0.1379, 'grad_norm': 0.08441487699747086, 'learning_rate': 1.4529198100027941e-05, 'epoch': 0.82}
{'loss': 0.2229, 'grad_norm': 1.7902106046676636, 'learning_rate': 1.4473316568873988e-05, 'epoch': 0.83}
{'loss': 0.2422, 'grad_norm': 1.3887587785720825, 'learning_rate': 1.4417435037720035e-05, 'epoch': 0.84}
{'loss': 0.1699, 'grad_norm': 1.0611412525177002, 'learning_rate': 1.4361553506566082e-05, 'epoch': 0.85}
{'loss': 0.1627, 'grad_norm': 0.11189001798629761, 'learning_rate': 1.4305671975412127e-05, 'epoch': 0.85}
{'loss': 0.1228, 'grad_norm': 7.543656826019287, 'learning_rate': 1.4249790444258174e-05, 'epoch': 0.86}
{'loss': 0.2464, 'grad_norm': 7.51128625869751, 'learning_rate': 1.4193908913104219e-05, 'epoch': 0.87}
{'loss': 0.1361, 'grad_norm': 2.5216290950775146, 'learning_rate': 1.4138027381950266e-05, 'epoch': 0.88}
{'loss': 0.0363, 'grad_norm': 4.999823570251465, 'learning_rate': 1.4082145850796315e-05, 'epoch': 0.89}
{'loss': 0.2896, 'grad_norm': 6.386994361877441, 'learning_rate': 1.402626431964236e-05, 'epoch': 0.9}
{'loss': 0.2002, 'grad_norm': 0.6898726224899292, 'learning_rate': 1.3970382788488405e-05, 'epoch': 0.91}
{'loss': 0.2451, 'grad_norm': 8.263057708740234, 'learning_rate': 1.3914501257334452e-05, 'epoch': 0.91}
{'loss': 0.0603, 'grad_norm': 0.293326199054718, 'learning_rate': 1.3858619726180497e-05, 'epoch': 0.92}
{'loss': 0.3533, 'grad_norm': 7.1919097900390625, 'learning_rate': 1.3802738195026544e-05, 'epoch': 0.93}
{'loss': 0.1607, 'grad_norm': 1.182407259941101, 'learning_rate': 1.3746856663872593e-05, 'epoch': 0.94}
{'loss': 0.1597, 'grad_norm': 1.0589194297790527, 'learning_rate': 1.3690975132718638e-05, 'epoch': 0.95}
{'loss': 0.1333, 'grad_norm': 0.17283137142658234, 'learning_rate': 1.3635093601564685e-05, 'epoch': 0.96}
{'loss': 0.2022, 'grad_norm': 0.06993170827627182, 'learning_rate': 1.357921207041073e-05, 'epoch': 0.96}
{'loss': 0.2691, 'grad_norm': 1.7884217500686646, 'learning_rate': 1.3523330539256775e-05, 'epoch': 0.97}
{'loss': 0.151, 'grad_norm': 0.09580940753221512, 'learning_rate': 1.3467449008102824e-05, 'epoch': 0.98}
{'loss': 0.1772, 'grad_norm': 0.1687973141670227, 'learning_rate': 1.341156747694887e-05, 'epoch': 0.99}
{'loss': 0.0463, 'grad_norm': 1.3075376749038696, 'learning_rate': 1.3355685945794916e-05, 'epoch': 1.0}
{'eval_loss': 0.19130776822566986, 'eval_runtime': 6.4893, 'eval_samples_per_second': 367.531, 'eval_steps_per_second': 46.076, 'epoch': 1.0}
 33%|██████████████████████████████████████████████                                                                                            | 1193/3579 [01:52<05:50,  6.81it/s/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.2196, 'grad_norm': 6.899861812591553, 'learning_rate': 1.3299804414640963e-05, 'epoch': 1.01}
{'loss': 0.0676, 'grad_norm': 0.1572723686695099, 'learning_rate': 1.3243922883487008e-05, 'epoch': 1.01}
{'loss': 0.2103, 'grad_norm': 14.076386451721191, 'learning_rate': 1.3188041352333055e-05, 'epoch': 1.02}
{'loss': 0.1815, 'grad_norm': 0.28444355726242065, 'learning_rate': 1.3132159821179102e-05, 'epoch': 1.03}
{'loss': 0.1, 'grad_norm': 6.667834281921387, 'learning_rate': 1.3076278290025149e-05, 'epoch': 1.04}
{'loss': 0.1876, 'grad_norm': 0.17899909615516663, 'learning_rate': 1.3020396758871194e-05, 'epoch': 1.05}
{'loss': 0.1573, 'grad_norm': 0.3098427653312683, 'learning_rate': 1.296451522771724e-05, 'epoch': 1.06}
{'loss': 0.1193, 'grad_norm': 2.7363998889923096, 'learning_rate': 1.2908633696563286e-05, 'epoch': 1.06}
{'loss': 0.0917, 'grad_norm': 14.840714454650879, 'learning_rate': 1.2852752165409333e-05, 'epoch': 1.07}
{'loss': 0.0808, 'grad_norm': 11.89546012878418, 'learning_rate': 1.279687063425538e-05, 'epoch': 1.08}
{'loss': 0.3522, 'grad_norm': 15.393187522888184, 'learning_rate': 1.2740989103101427e-05, 'epoch': 1.09}
{'loss': 0.0559, 'grad_norm': 0.7571815252304077, 'learning_rate': 1.2685107571947472e-05, 'epoch': 1.1}
{'loss': 0.1715, 'grad_norm': 10.731544494628906, 'learning_rate': 1.2629226040793519e-05, 'epoch': 1.11}
{'loss': 0.1042, 'grad_norm': 4.869638442993164, 'learning_rate': 1.2573344509639564e-05, 'epoch': 1.11}
{'loss': 0.1723, 'grad_norm': 7.457461357116699, 'learning_rate': 1.2517462978485611e-05, 'epoch': 1.12}
{'loss': 0.112, 'grad_norm': 0.4090295433998108, 'learning_rate': 1.246158144733166e-05, 'epoch': 1.13}
{'loss': 0.1299, 'grad_norm': 12.638312339782715, 'learning_rate': 1.2405699916177705e-05, 'epoch': 1.14}
{'loss': 0.0638, 'grad_norm': 4.632197380065918, 'learning_rate': 1.234981838502375e-05, 'epoch': 1.15}
{'loss': 0.1128, 'grad_norm': 11.371620178222656, 'learning_rate': 1.2293936853869797e-05, 'epoch': 1.16}
{'loss': 0.1555, 'grad_norm': 1.0987424850463867, 'learning_rate': 1.2238055322715842e-05, 'epoch': 1.17}
{'loss': 0.2163, 'grad_norm': 7.629696369171143, 'learning_rate': 1.2182173791561889e-05, 'epoch': 1.17}
{'loss': 0.1613, 'grad_norm': 1.023877739906311, 'learning_rate': 1.2126292260407938e-05, 'epoch': 1.18}
{'loss': 0.1562, 'grad_norm': 7.219164848327637, 'learning_rate': 1.2070410729253983e-05, 'epoch': 1.19}
{'loss': 0.1083, 'grad_norm': 4.898857593536377, 'learning_rate': 1.201452919810003e-05, 'epoch': 1.2}
{'loss': 0.2338, 'grad_norm': 0.5832620859146118, 'learning_rate': 1.1958647666946075e-05, 'epoch': 1.21}
{'loss': 0.1509, 'grad_norm': 0.1842060387134552, 'learning_rate': 1.190276613579212e-05, 'epoch': 1.22}
{'loss': 0.178, 'grad_norm': 0.8965232968330383, 'learning_rate': 1.1846884604638169e-05, 'epoch': 1.22}
{'loss': 0.2908, 'grad_norm': 7.611271381378174, 'learning_rate': 1.1791003073484216e-05, 'epoch': 1.23}
{'loss': 0.1631, 'grad_norm': 11.767334938049316, 'learning_rate': 1.173512154233026e-05, 'epoch': 1.24}
{'loss': 0.111, 'grad_norm': 3.6931755542755127, 'learning_rate': 1.1679240011176308e-05, 'epoch': 1.25}
{'loss': 0.0416, 'grad_norm': 8.808243751525879, 'learning_rate': 1.1623358480022353e-05, 'epoch': 1.26}
{'loss': 0.2674, 'grad_norm': 0.05223482847213745, 'learning_rate': 1.15674769488684e-05, 'epoch': 1.27}
{'loss': 0.0656, 'grad_norm': 0.05553990975022316, 'learning_rate': 1.1511595417714447e-05, 'epoch': 1.27}
{'loss': 0.0964, 'grad_norm': 0.037371329963207245, 'learning_rate': 1.1455713886560494e-05, 'epoch': 1.28}
{'loss': 0.1524, 'grad_norm': 16.123790740966797, 'learning_rate': 1.1399832355406539e-05, 'epoch': 1.29}
{'loss': 0.1286, 'grad_norm': 5.083310127258301, 'learning_rate': 1.1343950824252586e-05, 'epoch': 1.3}
{'loss': 0.1946, 'grad_norm': 7.8983154296875, 'learning_rate': 1.1288069293098631e-05, 'epoch': 1.31}
{'loss': 0.0927, 'grad_norm': 0.8282314538955688, 'learning_rate': 1.1232187761944678e-05, 'epoch': 1.32}
{'loss': 0.1549, 'grad_norm': 18.01129722595215, 'learning_rate': 1.1176306230790725e-05, 'epoch': 1.32}
{'loss': 0.019, 'grad_norm': 0.20258976519107819, 'learning_rate': 1.1120424699636772e-05, 'epoch': 1.33}
{'loss': 0.1026, 'grad_norm': 0.033167678862810135, 'learning_rate': 1.1064543168482817e-05, 'epoch': 1.34}
{'loss': 0.0949, 'grad_norm': 0.057488441467285156, 'learning_rate': 1.1008661637328864e-05, 'epoch': 1.35}
{'loss': 0.3486, 'grad_norm': 14.474258422851562, 'learning_rate': 1.0952780106174909e-05, 'epoch': 1.36}
{'loss': 0.1501, 'grad_norm': 0.04577210173010826, 'learning_rate': 1.0896898575020956e-05, 'epoch': 1.37}
{'loss': 0.0717, 'grad_norm': 0.24350592494010925, 'learning_rate': 1.0841017043867004e-05, 'epoch': 1.37}
{'loss': 0.0794, 'grad_norm': 13.15726375579834, 'learning_rate': 1.078513551271305e-05, 'epoch': 1.38}
{'loss': 0.2308, 'grad_norm': 0.06889619678258896, 'learning_rate': 1.0729253981559097e-05, 'epoch': 1.39}
{'loss': 0.111, 'grad_norm': 9.236833572387695, 'learning_rate': 1.0673372450405142e-05, 'epoch': 1.4}
{'loss': 0.1222, 'grad_norm': 14.055639266967773, 'learning_rate': 1.0617490919251187e-05, 'epoch': 1.41}
{'loss': 0.1984, 'grad_norm': 13.2432279586792, 'learning_rate': 1.0561609388097234e-05, 'epoch': 1.42}
{'loss': 0.0478, 'grad_norm': 3.7488646507263184, 'learning_rate': 1.0505727856943282e-05, 'epoch': 1.42}
{'loss': 0.2128, 'grad_norm': 16.26830291748047, 'learning_rate': 1.0449846325789328e-05, 'epoch': 1.43}
{'loss': 0.265, 'grad_norm': 20.294300079345703, 'learning_rate': 1.0393964794635375e-05, 'epoch': 1.44}
{'loss': 0.0649, 'grad_norm': 0.05036007985472679, 'learning_rate': 1.033808326348142e-05, 'epoch': 1.45}
{'loss': 0.0832, 'grad_norm': 0.34440749883651733, 'learning_rate': 1.0282201732327467e-05, 'epoch': 1.46}
{'loss': 0.0476, 'grad_norm': 0.05158000811934471, 'learning_rate': 1.0226320201173514e-05, 'epoch': 1.47}
{'loss': 0.2228, 'grad_norm': 0.0504954531788826, 'learning_rate': 1.017043867001956e-05, 'epoch': 1.48}
{'loss': 0.1133, 'grad_norm': 7.953207969665527, 'learning_rate': 1.0114557138865606e-05, 'epoch': 1.48}
{'loss': 0.0446, 'grad_norm': 0.037467315793037415, 'learning_rate': 1.0058675607711653e-05, 'epoch': 1.49}
{'loss': 0.1433, 'grad_norm': 12.863460540771484, 'learning_rate': 1.0002794076557698e-05, 'epoch': 1.5}
{'loss': 0.0274, 'grad_norm': 2.527411699295044, 'learning_rate': 9.946912545403745e-06, 'epoch': 1.51}
{'loss': 0.0398, 'grad_norm': 0.030841656029224396, 'learning_rate': 9.891031014249792e-06, 'epoch': 1.52}
{'loss': 0.0575, 'grad_norm': 2.711507558822632, 'learning_rate': 9.835149483095837e-06, 'epoch': 1.53}
{'loss': 0.2336, 'grad_norm': 0.07700357586145401, 'learning_rate': 9.779267951941884e-06, 'epoch': 1.53}
{'loss': 0.0826, 'grad_norm': 24.128232955932617, 'learning_rate': 9.72338642078793e-06, 'epoch': 1.54}
{'loss': 0.1143, 'grad_norm': 0.030213991180062294, 'learning_rate': 9.667504889633976e-06, 'epoch': 1.55}
{'loss': 0.055, 'grad_norm': 13.198322296142578, 'learning_rate': 9.611623358480023e-06, 'epoch': 1.56}
{'loss': 0.0863, 'grad_norm': 2.263967990875244, 'learning_rate': 9.55574182732607e-06, 'epoch': 1.57}
{'loss': 0.1307, 'grad_norm': 0.6408737301826477, 'learning_rate': 9.499860296172115e-06, 'epoch': 1.58}
{'loss': 0.0514, 'grad_norm': 8.936378479003906, 'learning_rate': 9.443978765018162e-06, 'epoch': 1.58}
{'loss': 0.1285, 'grad_norm': 1.5300251245498657, 'learning_rate': 9.388097233864209e-06, 'epoch': 1.59}
{'loss': 0.1376, 'grad_norm': 17.134153366088867, 'learning_rate': 9.332215702710256e-06, 'epoch': 1.6}
{'loss': 0.1406, 'grad_norm': 0.0287639033049345, 'learning_rate': 9.2763341715563e-06, 'epoch': 1.61}
{'loss': 0.1272, 'grad_norm': 0.6421911120414734, 'learning_rate': 9.220452640402348e-06, 'epoch': 1.62}
{'loss': 0.081, 'grad_norm': 3.212911367416382, 'learning_rate': 9.164571109248395e-06, 'epoch': 1.63}
{'loss': 0.1193, 'grad_norm': 0.06764490157365799, 'learning_rate': 9.108689578094441e-06, 'epoch': 1.63}
{'loss': 0.196, 'grad_norm': 0.0545973926782608, 'learning_rate': 9.052808046940487e-06, 'epoch': 1.64}
{'loss': 0.0431, 'grad_norm': 0.7546164989471436, 'learning_rate': 8.996926515786534e-06, 'epoch': 1.65}
{'loss': 0.1581, 'grad_norm': 0.10768468677997589, 'learning_rate': 8.94104498463258e-06, 'epoch': 1.66}
{'loss': 0.0307, 'grad_norm': 17.35564613342285, 'learning_rate': 8.885163453478626e-06, 'epoch': 1.67}
{'loss': 0.0805, 'grad_norm': 0.04242414981126785, 'learning_rate': 8.829281922324673e-06, 'epoch': 1.68}
{'loss': 0.0642, 'grad_norm': 0.7704952955245972, 'learning_rate': 8.77340039117072e-06, 'epoch': 1.68}
{'loss': 0.1265, 'grad_norm': 7.264756202697754, 'learning_rate': 8.717518860016765e-06, 'epoch': 1.69}
{'loss': 0.1094, 'grad_norm': 1.32707941532135, 'learning_rate': 8.661637328862812e-06, 'epoch': 1.7}
{'loss': 0.1575, 'grad_norm': 9.746423721313477, 'learning_rate': 8.605755797708858e-06, 'epoch': 1.71}
{'loss': 0.0174, 'grad_norm': 0.024955255910754204, 'learning_rate': 8.549874266554904e-06, 'epoch': 1.72}
{'loss': 0.1204, 'grad_norm': 0.024285947903990746, 'learning_rate': 8.49399273540095e-06, 'epoch': 1.73}
{'loss': 0.0353, 'grad_norm': 0.706207811832428, 'learning_rate': 8.438111204246997e-06, 'epoch': 1.74}
{'loss': 0.1122, 'grad_norm': 4.977275371551514, 'learning_rate': 8.382229673093043e-06, 'epoch': 1.74}
{'loss': 0.1973, 'grad_norm': 0.1273682713508606, 'learning_rate': 8.32634814193909e-06, 'epoch': 1.75}
{'loss': 0.1774, 'grad_norm': 19.17932891845703, 'learning_rate': 8.270466610785136e-06, 'epoch': 1.76}
{'loss': 0.3934, 'grad_norm': 0.07597120851278305, 'learning_rate': 8.214585079631182e-06, 'epoch': 1.77}
{'loss': 0.0782, 'grad_norm': 0.7771133184432983, 'learning_rate': 8.158703548477229e-06, 'epoch': 1.78}
{'loss': 0.2292, 'grad_norm': 15.426770210266113, 'learning_rate': 8.102822017323276e-06, 'epoch': 1.79}
{'loss': 0.1718, 'grad_norm': 0.1651201844215393, 'learning_rate': 8.04694048616932e-06, 'epoch': 1.79}
{'loss': 0.1191, 'grad_norm': 5.8890275955200195, 'learning_rate': 7.991058955015368e-06, 'epoch': 1.8}
{'loss': 0.3131, 'grad_norm': 0.28144603967666626, 'learning_rate': 7.935177423861415e-06, 'epoch': 1.81}
{'loss': 0.1084, 'grad_norm': 12.897603034973145, 'learning_rate': 7.87929589270746e-06, 'epoch': 1.82}
{'loss': 0.0249, 'grad_norm': 0.024594509974122047, 'learning_rate': 7.823414361553507e-06, 'epoch': 1.83}
{'loss': 0.148, 'grad_norm': 0.08675245195627213, 'learning_rate': 7.767532830399554e-06, 'epoch': 1.84}
{'loss': 0.1641, 'grad_norm': 7.08911657333374, 'learning_rate': 7.711651299245599e-06, 'epoch': 1.84}
{'loss': 0.1435, 'grad_norm': 16.766250610351562, 'learning_rate': 7.655769768091647e-06, 'epoch': 1.85}
{'loss': 0.1589, 'grad_norm': 0.42993810772895813, 'learning_rate': 7.5998882369376925e-06, 'epoch': 1.86}
{'loss': 0.0461, 'grad_norm': 0.3876899480819702, 'learning_rate': 7.5440067057837394e-06, 'epoch': 1.87}
{'loss': 0.0798, 'grad_norm': 0.03778419643640518, 'learning_rate': 7.4881251746297855e-06, 'epoch': 1.88}
{'loss': 0.1055, 'grad_norm': 0.025127394124865532, 'learning_rate': 7.4322436434758315e-06, 'epoch': 1.89}
{'loss': 0.4114, 'grad_norm': 17.766122817993164, 'learning_rate': 7.3763621123218785e-06, 'epoch': 1.89}
{'loss': 0.2284, 'grad_norm': 0.3176211714744568, 'learning_rate': 7.3204805811679245e-06, 'epoch': 1.9}
{'loss': 0.2328, 'grad_norm': 0.12112674862146378, 'learning_rate': 7.2645990500139706e-06, 'epoch': 1.91}
{'loss': 0.1766, 'grad_norm': 5.743581295013428, 'learning_rate': 7.2087175188600175e-06, 'epoch': 1.92}
{'loss': 0.0333, 'grad_norm': 0.310889333486557, 'learning_rate': 7.1528359877060635e-06, 'epoch': 1.93}
{'loss': 0.0842, 'grad_norm': 0.1799372136592865, 'learning_rate': 7.0969544565521096e-06, 'epoch': 1.94}
{'loss': 0.1346, 'grad_norm': 0.13869434595108032, 'learning_rate': 7.041072925398157e-06, 'epoch': 1.94}
{'loss': 0.0711, 'grad_norm': 0.03450339287519455, 'learning_rate': 6.9851913942442025e-06, 'epoch': 1.95}
{'loss': 0.2993, 'grad_norm': 0.053364645689725876, 'learning_rate': 6.929309863090249e-06, 'epoch': 1.96}
{'loss': 0.0938, 'grad_norm': 4.455291748046875, 'learning_rate': 6.873428331936296e-06, 'epoch': 1.97}
{'loss': 0.1679, 'grad_norm': 0.26701733469963074, 'learning_rate': 6.817546800782342e-06, 'epoch': 1.98}
{'loss': 0.1631, 'grad_norm': 6.626768112182617, 'learning_rate': 6.761665269628388e-06, 'epoch': 1.99}
{'loss': 0.2273, 'grad_norm': 10.02287483215332, 'learning_rate': 6.705783738474435e-06, 'epoch': 1.99}
{'eval_loss': 0.15171200037002563, 'eval_runtime': 6.5129, 'eval_samples_per_second': 366.198, 'eval_steps_per_second': 45.909, 'epoch': 2.0}
 67%|████████████████████████████████████████████████████████████████████████████████████████████                                              | 2386/3579 [03:44<01:40, 11.84it/s/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.0629, 'grad_norm': 0.06400899589061737, 'learning_rate': 6.649902207320481e-06, 'epoch': 2.0}
{'loss': 0.1004, 'grad_norm': 1.4807556867599487, 'learning_rate': 6.5940206761665274e-06, 'epoch': 2.01}
{'loss': 0.1404, 'grad_norm': 13.795388221740723, 'learning_rate': 6.538139145012574e-06, 'epoch': 2.02}
{'loss': 0.0485, 'grad_norm': 0.05556923896074295, 'learning_rate': 6.48225761385862e-06, 'epoch': 2.03}
{'loss': 0.1205, 'grad_norm': 12.081756591796875, 'learning_rate': 6.4263760827046665e-06, 'epoch': 2.04}
{'loss': 0.1238, 'grad_norm': 1.113044261932373, 'learning_rate': 6.370494551550713e-06, 'epoch': 2.05}
{'loss': 0.1057, 'grad_norm': 0.23343205451965332, 'learning_rate': 6.314613020396759e-06, 'epoch': 2.05}
{'loss': 0.0788, 'grad_norm': 0.07355056703090668, 'learning_rate': 6.2587314892428055e-06, 'epoch': 2.06}
{'loss': 0.0638, 'grad_norm': 1.1969867944717407, 'learning_rate': 6.202849958088852e-06, 'epoch': 2.07}
{'loss': 0.0371, 'grad_norm': 0.02816159278154373, 'learning_rate': 6.1469684269348984e-06, 'epoch': 2.08}
{'loss': 0.0584, 'grad_norm': 0.02202824503183365, 'learning_rate': 6.0910868957809445e-06, 'epoch': 2.09}
{'loss': 0.1177, 'grad_norm': 0.034981779754161835, 'learning_rate': 6.035205364626991e-06, 'epoch': 2.1}
{'loss': 0.1044, 'grad_norm': 0.14655046164989471, 'learning_rate': 5.9793238334730374e-06, 'epoch': 2.1}
{'loss': 0.0052, 'grad_norm': 0.028718044981360435, 'learning_rate': 5.923442302319084e-06, 'epoch': 2.11}
{'loss': 0.0827, 'grad_norm': 14.998878479003906, 'learning_rate': 5.86756077116513e-06, 'epoch': 2.12}
{'loss': 0.1364, 'grad_norm': 0.18278786540031433, 'learning_rate': 5.8116792400111764e-06, 'epoch': 2.13}
{'loss': 0.0081, 'grad_norm': 0.17875567078590393, 'learning_rate': 5.755797708857223e-06, 'epoch': 2.14}
{'loss': 0.0524, 'grad_norm': 0.021319352090358734, 'learning_rate': 5.699916177703269e-06, 'epoch': 2.15}
{'loss': 0.1374, 'grad_norm': 0.14667676389217377, 'learning_rate': 5.6440346465493155e-06, 'epoch': 2.15}
{'loss': 0.0648, 'grad_norm': 0.5341949462890625, 'learning_rate': 5.588153115395362e-06, 'epoch': 2.16}
{'loss': 0.0876, 'grad_norm': 0.07070862501859665, 'learning_rate': 5.532271584241408e-06, 'epoch': 2.17}
{'loss': 0.1035, 'grad_norm': 0.44625669717788696, 'learning_rate': 5.4763900530874545e-06, 'epoch': 2.18}
{'loss': 0.0179, 'grad_norm': 0.0638960748910904, 'learning_rate': 5.420508521933502e-06, 'epoch': 2.19}
{'loss': 0.1222, 'grad_norm': 2.4634737968444824, 'learning_rate': 5.364626990779548e-06, 'epoch': 2.2}
{'loss': 0.0756, 'grad_norm': 4.091899871826172, 'learning_rate': 5.3087454596255935e-06, 'epoch': 2.2}
{'loss': 0.0129, 'grad_norm': 0.0631915032863617, 'learning_rate': 5.252863928471641e-06, 'epoch': 2.21}
{'loss': 0.1525, 'grad_norm': 28.263992309570312, 'learning_rate': 5.196982397317687e-06, 'epoch': 2.22}
{'loss': 0.0247, 'grad_norm': 0.1484491527080536, 'learning_rate': 5.141100866163733e-06, 'epoch': 2.23}
{'loss': 0.0532, 'grad_norm': 1.6057777404785156, 'learning_rate': 5.08521933500978e-06, 'epoch': 2.24}
{'loss': 0.1014, 'grad_norm': 2.920083999633789, 'learning_rate': 5.029337803855826e-06, 'epoch': 2.25}
{'loss': 0.1125, 'grad_norm': 17.21710205078125, 'learning_rate': 4.973456272701872e-06, 'epoch': 2.25}
{'loss': 0.1807, 'grad_norm': 2.2793233394622803, 'learning_rate': 4.917574741547918e-06, 'epoch': 2.26}
{'loss': 0.0047, 'grad_norm': 0.0847991481423378, 'learning_rate': 4.861693210393965e-06, 'epoch': 2.27}
{'loss': 0.0089, 'grad_norm': 0.20518003404140472, 'learning_rate': 4.805811679240011e-06, 'epoch': 2.28}
{'loss': 0.129, 'grad_norm': 3.0755865573883057, 'learning_rate': 4.749930148086057e-06, 'epoch': 2.29}
{'loss': 0.1562, 'grad_norm': 0.016460783779621124, 'learning_rate': 4.694048616932104e-06, 'epoch': 2.3}
{'loss': 0.0563, 'grad_norm': 0.9970759153366089, 'learning_rate': 4.63816708577815e-06, 'epoch': 2.31}
{'loss': 0.049, 'grad_norm': 9.916376113891602, 'learning_rate': 4.582285554624197e-06, 'epoch': 2.31}
{'loss': 0.009, 'grad_norm': 5.438902378082275, 'learning_rate': 4.526404023470243e-06, 'epoch': 2.32}
{'loss': 0.1246, 'grad_norm': 1.129791498184204, 'learning_rate': 4.47052249231629e-06, 'epoch': 2.33}
{'loss': 0.0046, 'grad_norm': 0.06186562031507492, 'learning_rate': 4.414640961162336e-06, 'epoch': 2.34}
{'loss': 0.0098, 'grad_norm': 0.0135613102465868, 'learning_rate': 4.358759430008382e-06, 'epoch': 2.35}
{'loss': 0.019, 'grad_norm': 0.011312214657664299, 'learning_rate': 4.302877898854429e-06, 'epoch': 2.36}
{'loss': 0.0195, 'grad_norm': 4.652972221374512, 'learning_rate': 4.246996367700475e-06, 'epoch': 2.36}
{'loss': 0.0197, 'grad_norm': 0.029717590659856796, 'learning_rate': 4.191114836546521e-06, 'epoch': 2.37}
{'loss': 0.0232, 'grad_norm': 0.012066887691617012, 'learning_rate': 4.135233305392568e-06, 'epoch': 2.38}
{'loss': 0.1785, 'grad_norm': 0.02020217664539814, 'learning_rate': 4.079351774238614e-06, 'epoch': 2.39}
{'loss': 0.0955, 'grad_norm': 0.050053760409355164, 'learning_rate': 4.02347024308466e-06, 'epoch': 2.4}
{'loss': 0.0985, 'grad_norm': 34.8054313659668, 'learning_rate': 3.967588711930707e-06, 'epoch': 2.41}
{'loss': 0.0389, 'grad_norm': 0.014034920372068882, 'learning_rate': 3.911707180776753e-06, 'epoch': 2.41}
{'loss': 0.1735, 'grad_norm': 15.015890121459961, 'learning_rate': 3.855825649622799e-06, 'epoch': 2.42}
{'loss': 0.0649, 'grad_norm': 0.019592244178056717, 'learning_rate': 3.7999441184688463e-06, 'epoch': 2.43}
{'loss': 0.0417, 'grad_norm': 10.195293426513672, 'learning_rate': 3.7440625873148927e-06, 'epoch': 2.44}
{'loss': 0.013, 'grad_norm': 1.4238715171813965, 'learning_rate': 3.6881810561609392e-06, 'epoch': 2.45}
{'loss': 0.0083, 'grad_norm': 0.07433265447616577, 'learning_rate': 3.6322995250069853e-06, 'epoch': 2.46}
{'loss': 0.1491, 'grad_norm': 16.964563369750977, 'learning_rate': 3.5764179938530318e-06, 'epoch': 2.46}
{'loss': 0.0178, 'grad_norm': 0.20281052589416504, 'learning_rate': 3.5205364626990787e-06, 'epoch': 2.47}
{'loss': 0.0066, 'grad_norm': 1.0457899570465088, 'learning_rate': 3.4646549315451243e-06, 'epoch': 2.48}
{'loss': 0.0609, 'grad_norm': 0.03605854511260986, 'learning_rate': 3.408773400391171e-06, 'epoch': 2.49}
{'loss': 0.0576, 'grad_norm': 5.558776378631592, 'learning_rate': 3.3528918692372177e-06, 'epoch': 2.5}
{'loss': 0.0531, 'grad_norm': 0.011548780836164951, 'learning_rate': 3.2970103380832637e-06, 'epoch': 2.51}
{'loss': 0.0329, 'grad_norm': 0.5044761896133423, 'learning_rate': 3.24112880692931e-06, 'epoch': 2.51}
{'loss': 0.0362, 'grad_norm': 0.04616136848926544, 'learning_rate': 3.1852472757753567e-06, 'epoch': 2.52}
{'loss': 0.0628, 'grad_norm': 0.05137329548597336, 'learning_rate': 3.1293657446214027e-06, 'epoch': 2.53}
{'loss': 0.1157, 'grad_norm': 0.010463816113770008, 'learning_rate': 3.0734842134674492e-06, 'epoch': 2.54}
{'loss': 0.0238, 'grad_norm': 0.012381809763610363, 'learning_rate': 3.0176026823134957e-06, 'epoch': 2.55}
{'loss': 0.1169, 'grad_norm': 24.909982681274414, 'learning_rate': 2.961721151159542e-06, 'epoch': 2.56}
{'loss': 0.1565, 'grad_norm': 6.758872985839844, 'learning_rate': 2.9058396200055882e-06, 'epoch': 2.56}
{'loss': 0.0751, 'grad_norm': 0.1434357613325119, 'learning_rate': 2.8499580888516347e-06, 'epoch': 2.57}
{'loss': 0.0216, 'grad_norm': 0.014972196891903877, 'learning_rate': 2.794076557697681e-06, 'epoch': 2.58}
{'loss': 0.0533, 'grad_norm': 5.653558731079102, 'learning_rate': 2.7381950265437272e-06, 'epoch': 2.59}
{'loss': 0.0039, 'grad_norm': 0.033545028418302536, 'learning_rate': 2.682313495389774e-06, 'epoch': 2.6}
{'loss': 0.0044, 'grad_norm': 0.0650448128581047, 'learning_rate': 2.6264319642358206e-06, 'epoch': 2.61}
{'loss': 0.1111, 'grad_norm': 0.012551816180348396, 'learning_rate': 2.5705504330818667e-06, 'epoch': 2.62}
{'loss': 0.024, 'grad_norm': 0.03938116505742073, 'learning_rate': 2.514668901927913e-06, 'epoch': 2.62}
{'loss': 0.022, 'grad_norm': 0.030421512201428413, 'learning_rate': 2.458787370773959e-06, 'epoch': 2.63}
{'loss': 0.007, 'grad_norm': 1.6142696142196655, 'learning_rate': 2.4029058396200057e-06, 'epoch': 2.64}
{'loss': 0.1869, 'grad_norm': 35.88170623779297, 'learning_rate': 2.347024308466052e-06, 'epoch': 2.65}
{'loss': 0.0522, 'grad_norm': 0.14984707534313202, 'learning_rate': 2.2911427773120986e-06, 'epoch': 2.66}
{'loss': 0.06, 'grad_norm': 20.603506088256836, 'learning_rate': 2.235261246158145e-06, 'epoch': 2.67}
{'loss': 0.0437, 'grad_norm': 0.010345561429858208, 'learning_rate': 2.179379715004191e-06, 'epoch': 2.67}
{'loss': 0.0143, 'grad_norm': 0.011618540622293949, 'learning_rate': 2.1234981838502376e-06, 'epoch': 2.68}
{'loss': 0.1025, 'grad_norm': 0.011026083491742611, 'learning_rate': 2.067616652696284e-06, 'epoch': 2.69}
{'loss': 0.0719, 'grad_norm': 2.0245418548583984, 'learning_rate': 2.01173512154233e-06, 'epoch': 2.7}
{'loss': 0.0601, 'grad_norm': 0.37118154764175415, 'learning_rate': 1.9558535903883767e-06, 'epoch': 2.71}
{'loss': 0.0773, 'grad_norm': 0.08310052007436752, 'learning_rate': 1.8999720592344231e-06, 'epoch': 2.72}
{'loss': 0.0029, 'grad_norm': 0.40727898478507996, 'learning_rate': 1.8440905280804696e-06, 'epoch': 2.72}
{'loss': 0.0949, 'grad_norm': 0.010084823705255985, 'learning_rate': 1.7882089969265159e-06, 'epoch': 2.73}
{'loss': 0.1437, 'grad_norm': 1.1800950765609741, 'learning_rate': 1.7323274657725621e-06, 'epoch': 2.74}
{'loss': 0.0238, 'grad_norm': 0.01769084483385086, 'learning_rate': 1.6764459346186088e-06, 'epoch': 2.75}
{'loss': 0.0682, 'grad_norm': 29.74684715270996, 'learning_rate': 1.620564403464655e-06, 'epoch': 2.76}
{'loss': 0.053, 'grad_norm': 17.362163543701172, 'learning_rate': 1.5646828723107014e-06, 'epoch': 2.77}
{'loss': 0.004, 'grad_norm': 2.472644090652466, 'learning_rate': 1.5088013411567478e-06, 'epoch': 2.77}
{'loss': 0.1426, 'grad_norm': 20.97197723388672, 'learning_rate': 1.4529198100027941e-06, 'epoch': 2.78}
{'loss': 0.1845, 'grad_norm': 0.010403015650808811, 'learning_rate': 1.3970382788488406e-06, 'epoch': 2.79}
{'loss': 0.1385, 'grad_norm': 0.03994228318333626, 'learning_rate': 1.341156747694887e-06, 'epoch': 2.8}
{'loss': 0.1217, 'grad_norm': 30.52672004699707, 'learning_rate': 1.2852752165409333e-06, 'epoch': 2.81}
{'loss': 0.0822, 'grad_norm': 11.006372451782227, 'learning_rate': 1.2293936853869796e-06, 'epoch': 2.82}
{'loss': 0.0124, 'grad_norm': 0.017864836379885674, 'learning_rate': 1.173512154233026e-06, 'epoch': 2.82}
{'loss': 0.0053, 'grad_norm': 2.2224948406219482, 'learning_rate': 1.1176306230790726e-06, 'epoch': 2.83}
{'loss': 0.0574, 'grad_norm': 0.014469660818576813, 'learning_rate': 1.0617490919251188e-06, 'epoch': 2.84}
{'loss': 0.1695, 'grad_norm': 11.64688491821289, 'learning_rate': 1.005867560771165e-06, 'epoch': 2.85}
{'loss': 0.0377, 'grad_norm': 0.10125039517879486, 'learning_rate': 9.499860296172116e-07, 'epoch': 2.86}
{'loss': 0.1004, 'grad_norm': 0.03449943661689758, 'learning_rate': 8.941044984632579e-07, 'epoch': 2.87}
{'loss': 0.029, 'grad_norm': 0.016353361308574677, 'learning_rate': 8.382229673093044e-07, 'epoch': 2.88}
{'loss': 0.0071, 'grad_norm': 0.011022208258509636, 'learning_rate': 7.823414361553507e-07, 'epoch': 2.88}
{'loss': 0.0373, 'grad_norm': 0.024787507951259613, 'learning_rate': 7.264599050013971e-07, 'epoch': 2.89}
{'loss': 0.0811, 'grad_norm': 0.2142615169286728, 'learning_rate': 6.705783738474435e-07, 'epoch': 2.9}
{'loss': 0.0831, 'grad_norm': 18.616695404052734, 'learning_rate': 6.146968426934898e-07, 'epoch': 2.91}
{'loss': 0.0432, 'grad_norm': 0.06807021051645279, 'learning_rate': 5.588153115395363e-07, 'epoch': 2.92}
{'loss': 0.0324, 'grad_norm': 0.04289417713880539, 'learning_rate': 5.029337803855825e-07, 'epoch': 2.93}
{'loss': 0.0464, 'grad_norm': 11.02008056640625, 'learning_rate': 4.4705224923162897e-07, 'epoch': 2.93}
{'loss': 0.0564, 'grad_norm': 0.07863041013479233, 'learning_rate': 3.9117071807767534e-07, 'epoch': 2.94}
{'loss': 0.0412, 'grad_norm': 5.951130390167236, 'learning_rate': 3.3528918692372177e-07, 'epoch': 2.95}
{'loss': 0.0095, 'grad_norm': 0.017952250316739082, 'learning_rate': 2.7940765576976814e-07, 'epoch': 2.96}
{'loss': 0.0822, 'grad_norm': 0.05481330305337906, 'learning_rate': 2.2352612461581448e-07, 'epoch': 2.97}
{'loss': 0.1147, 'grad_norm': 0.01857118122279644, 'learning_rate': 1.6764459346186088e-07, 'epoch': 2.98}
{'loss': 0.0433, 'grad_norm': 0.38910889625549316, 'learning_rate': 1.1176306230790724e-07, 'epoch': 2.98}
{'loss': 0.0538, 'grad_norm': 13.516304016113281, 'learning_rate': 5.588153115395362e-08, 'epoch': 2.99}
{'eval_loss': 0.21390825510025024, 'eval_runtime': 6.5455, 'eval_samples_per_second': 364.371, 'eval_steps_per_second': 45.68, 'epoch': 3.0}
{'train_runtime': 338.6663, 'train_samples_per_second': 84.49, 'train_steps_per_second': 10.568, 'train_loss': 0.14041846053277723, 'epoch': 3.0}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3579/3579 [05:38<00:00, 10.57it/s]
2025-04-30 00:13:43,091 - INFO - Fine-tuning Gradient-style Sentiment model...
  0%|                                                                                                                                                     | 0/3579 [00:00<?, ?it/s]/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.0687, 'grad_norm': 0.4299670457839966, 'learning_rate': 1.9949706621961446e-05, 'epoch': 0.01}
{'loss': 0.0807, 'grad_norm': 0.22620926797389984, 'learning_rate': 1.989382509080749e-05, 'epoch': 0.02}
{'loss': 0.0289, 'grad_norm': 0.1333957463502884, 'learning_rate': 1.9837943559653536e-05, 'epoch': 0.03}
{'loss': 0.0379, 'grad_norm': 0.10286043584346771, 'learning_rate': 1.9782062028499583e-05, 'epoch': 0.03}
{'loss': 0.0708, 'grad_norm': 1.183078646659851, 'learning_rate': 1.9726180497345627e-05, 'epoch': 0.04}
{'loss': 0.0556, 'grad_norm': 0.28256934881210327, 'learning_rate': 1.9670298966191674e-05, 'epoch': 0.05}
{'loss': 0.0239, 'grad_norm': 1.0123145580291748, 'learning_rate': 1.9614417435037724e-05, 'epoch': 0.06}
{'loss': 0.0602, 'grad_norm': 0.7033633589744568, 'learning_rate': 1.9558535903883767e-05, 'epoch': 0.07}
{'loss': 0.0602, 'grad_norm': 0.3946830928325653, 'learning_rate': 1.9502654372729814e-05, 'epoch': 0.08}
{'loss': 0.0462, 'grad_norm': 1.039506196975708, 'learning_rate': 1.944677284157586e-05, 'epoch': 0.08}
{'loss': 0.0642, 'grad_norm': 1.3578848838806152, 'learning_rate': 1.9390891310421908e-05, 'epoch': 0.09}
{'loss': 0.0769, 'grad_norm': 2.7052230834960938, 'learning_rate': 1.933500977926795e-05, 'epoch': 0.1}
{'loss': 0.0723, 'grad_norm': 1.3602306842803955, 'learning_rate': 1.9279128248114002e-05, 'epoch': 0.11}
{'loss': 0.0421, 'grad_norm': 0.195251002907753, 'learning_rate': 1.9223246716960045e-05, 'epoch': 0.12}
{'loss': 0.0311, 'grad_norm': 0.26406311988830566, 'learning_rate': 1.9167365185806092e-05, 'epoch': 0.13}
{'loss': 0.0701, 'grad_norm': 1.2052409648895264, 'learning_rate': 1.911148365465214e-05, 'epoch': 0.13}
{'loss': 0.0992, 'grad_norm': 1.1782923936843872, 'learning_rate': 1.9055602123498186e-05, 'epoch': 0.14}
{'loss': 0.0618, 'grad_norm': 0.17687712609767914, 'learning_rate': 1.899972059234423e-05, 'epoch': 0.15}
{'loss': 0.0689, 'grad_norm': 1.1098850965499878, 'learning_rate': 1.894383906119028e-05, 'epoch': 0.16}
{'loss': 0.0556, 'grad_norm': 2.07857608795166, 'learning_rate': 1.8887957530036323e-05, 'epoch': 0.17}
{'loss': 0.0475, 'grad_norm': 0.4362657964229584, 'learning_rate': 1.883207599888237e-05, 'epoch': 0.18}
{'loss': 0.0277, 'grad_norm': 0.43568718433380127, 'learning_rate': 1.8776194467728417e-05, 'epoch': 0.18}
{'loss': 0.0337, 'grad_norm': 0.16049601137638092, 'learning_rate': 1.8720312936574464e-05, 'epoch': 0.19}
{'loss': 0.0602, 'grad_norm': 0.720198929309845, 'learning_rate': 1.866443140542051e-05, 'epoch': 0.2}
{'loss': 0.0966, 'grad_norm': 2.804612874984741, 'learning_rate': 1.8608549874266558e-05, 'epoch': 0.21}
{'loss': 0.08, 'grad_norm': 0.3701207935810089, 'learning_rate': 1.85526683431126e-05, 'epoch': 0.22}
{'loss': 0.027, 'grad_norm': 1.6479737758636475, 'learning_rate': 1.849678681195865e-05, 'epoch': 0.23}
{'loss': 0.0492, 'grad_norm': 1.1996506452560425, 'learning_rate': 1.8440905280804695e-05, 'epoch': 0.23}
{'loss': 0.0223, 'grad_norm': 0.20129063725471497, 'learning_rate': 1.8385023749650742e-05, 'epoch': 0.24}
{'loss': 0.0357, 'grad_norm': 0.5934904217720032, 'learning_rate': 1.832914221849679e-05, 'epoch': 0.25}
{'loss': 0.1111, 'grad_norm': 1.5075585842132568, 'learning_rate': 1.8273260687342836e-05, 'epoch': 0.26}
{'loss': 0.0577, 'grad_norm': 0.05743813142180443, 'learning_rate': 1.8217379156188883e-05, 'epoch': 0.27}
{'loss': 0.0353, 'grad_norm': 0.18948158621788025, 'learning_rate': 1.8161497625034926e-05, 'epoch': 0.28}
{'loss': 0.0937, 'grad_norm': 1.3431044816970825, 'learning_rate': 1.8105616093880973e-05, 'epoch': 0.28}
{'loss': 0.0521, 'grad_norm': 0.14805085957050323, 'learning_rate': 1.804973456272702e-05, 'epoch': 0.29}
{'loss': 0.0178, 'grad_norm': 0.39462947845458984, 'learning_rate': 1.7993853031573067e-05, 'epoch': 0.3}
{'loss': 0.0926, 'grad_norm': 1.2622027397155762, 'learning_rate': 1.7937971500419114e-05, 'epoch': 0.31}
{'loss': 0.0391, 'grad_norm': 1.4151225090026855, 'learning_rate': 1.788208996926516e-05, 'epoch': 0.32}
{'loss': 0.0463, 'grad_norm': 0.488419771194458, 'learning_rate': 1.7826208438111204e-05, 'epoch': 0.33}
{'loss': 0.0525, 'grad_norm': 0.1386394202709198, 'learning_rate': 1.777032690695725e-05, 'epoch': 0.34}
{'loss': 0.0162, 'grad_norm': 0.10101065039634705, 'learning_rate': 1.7714445375803298e-05, 'epoch': 0.34}
{'loss': 0.0387, 'grad_norm': 3.0468060970306396, 'learning_rate': 1.7658563844649345e-05, 'epoch': 0.35}
{'loss': 0.0463, 'grad_norm': 6.6763410568237305, 'learning_rate': 1.7602682313495392e-05, 'epoch': 0.36}
{'loss': 0.0745, 'grad_norm': 2.3047540187835693, 'learning_rate': 1.754680078234144e-05, 'epoch': 0.37}
{'loss': 0.0314, 'grad_norm': 1.475329875946045, 'learning_rate': 1.7490919251187482e-05, 'epoch': 0.38}
{'loss': 0.0338, 'grad_norm': 0.2576509714126587, 'learning_rate': 1.743503772003353e-05, 'epoch': 0.39}
{'loss': 0.0348, 'grad_norm': 0.05893215909600258, 'learning_rate': 1.7379156188879576e-05, 'epoch': 0.39}
{'loss': 0.0588, 'grad_norm': 0.1313748061656952, 'learning_rate': 1.7323274657725623e-05, 'epoch': 0.4}
{'loss': 0.0226, 'grad_norm': 0.20603162050247192, 'learning_rate': 1.726739312657167e-05, 'epoch': 0.41}
{'loss': 0.0489, 'grad_norm': 0.8130746483802795, 'learning_rate': 1.7211511595417717e-05, 'epoch': 0.42}
{'loss': 0.0349, 'grad_norm': 0.2643057107925415, 'learning_rate': 1.715563006426376e-05, 'epoch': 0.43}
{'loss': 0.042, 'grad_norm': 1.6119886636734009, 'learning_rate': 1.7099748533109807e-05, 'epoch': 0.44}
{'loss': 0.0355, 'grad_norm': 0.12382097542285919, 'learning_rate': 1.7043867001955858e-05, 'epoch': 0.44}
{'loss': 0.0114, 'grad_norm': 0.17678745090961456, 'learning_rate': 1.69879854708019e-05, 'epoch': 0.45}
{'loss': 0.0698, 'grad_norm': 0.20387685298919678, 'learning_rate': 1.6932103939647948e-05, 'epoch': 0.46}
{'loss': 0.0631, 'grad_norm': 2.0537149906158447, 'learning_rate': 1.6876222408493995e-05, 'epoch': 0.47}
{'loss': 0.0671, 'grad_norm': 0.15655899047851562, 'learning_rate': 1.682034087734004e-05, 'epoch': 0.48}
{'loss': 0.0917, 'grad_norm': 0.8534877300262451, 'learning_rate': 1.6764459346186085e-05, 'epoch': 0.49}
{'loss': 0.0371, 'grad_norm': 0.16980436444282532, 'learning_rate': 1.6708577815032136e-05, 'epoch': 0.49}
{'loss': 0.0185, 'grad_norm': 0.06828158348798752, 'learning_rate': 1.665269628387818e-05, 'epoch': 0.5}
{'loss': 0.0209, 'grad_norm': 0.26886817812919617, 'learning_rate': 1.6596814752724226e-05, 'epoch': 0.51}
{'loss': 0.0127, 'grad_norm': 0.1627497375011444, 'learning_rate': 1.6540933221570273e-05, 'epoch': 0.52}
{'loss': 0.0505, 'grad_norm': 0.49278023838996887, 'learning_rate': 1.648505169041632e-05, 'epoch': 0.53}
{'loss': 0.0209, 'grad_norm': 0.35465484857559204, 'learning_rate': 1.6429170159262363e-05, 'epoch': 0.54}
{'loss': 0.0131, 'grad_norm': 0.09303778409957886, 'learning_rate': 1.6373288628108414e-05, 'epoch': 0.54}
{'loss': 0.0671, 'grad_norm': 0.2859981954097748, 'learning_rate': 1.6317407096954457e-05, 'epoch': 0.55}
{'loss': 0.0157, 'grad_norm': 0.18449632823467255, 'learning_rate': 1.6261525565800504e-05, 'epoch': 0.56}
{'loss': 0.0638, 'grad_norm': 0.8473157286643982, 'learning_rate': 1.620564403464655e-05, 'epoch': 0.57}
{'loss': 0.0624, 'grad_norm': 1.4240493774414062, 'learning_rate': 1.6149762503492598e-05, 'epoch': 0.58}
{'loss': 0.0617, 'grad_norm': 0.1950540393590927, 'learning_rate': 1.609388097233864e-05, 'epoch': 0.59}
{'loss': 0.0355, 'grad_norm': 0.08409811556339264, 'learning_rate': 1.6037999441184692e-05, 'epoch': 0.6}
{'loss': 0.0541, 'grad_norm': 0.3268963098526001, 'learning_rate': 1.5982117910030735e-05, 'epoch': 0.6}
{'loss': 0.0132, 'grad_norm': 1.5594191551208496, 'learning_rate': 1.5926236378876782e-05, 'epoch': 0.61}
{'loss': 0.0918, 'grad_norm': 1.3433722257614136, 'learning_rate': 1.587035484772283e-05, 'epoch': 0.62}
{'loss': 0.0429, 'grad_norm': 0.06427213549613953, 'learning_rate': 1.5814473316568876e-05, 'epoch': 0.63}
{'loss': 0.0532, 'grad_norm': 0.21609799563884735, 'learning_rate': 1.575859178541492e-05, 'epoch': 0.64}
{'loss': 0.0472, 'grad_norm': 4.218784809112549, 'learning_rate': 1.570271025426097e-05, 'epoch': 0.65}
{'loss': 0.0276, 'grad_norm': 0.06514008343219757, 'learning_rate': 1.5646828723107013e-05, 'epoch': 0.65}
{'loss': 0.0508, 'grad_norm': 0.14984019100666046, 'learning_rate': 1.559094719195306e-05, 'epoch': 0.66}
{'loss': 0.0656, 'grad_norm': 1.6371809244155884, 'learning_rate': 1.5535065660799107e-05, 'epoch': 0.67}
{'loss': 0.0728, 'grad_norm': 0.09940775483846664, 'learning_rate': 1.5479184129645154e-05, 'epoch': 0.68}
{'loss': 0.0342, 'grad_norm': 0.9701154232025146, 'learning_rate': 1.5423302598491197e-05, 'epoch': 0.69}
{'loss': 0.0416, 'grad_norm': 2.3937628269195557, 'learning_rate': 1.5367421067337248e-05, 'epoch': 0.7}
{'loss': 0.0187, 'grad_norm': 0.13600963354110718, 'learning_rate': 1.5311539536183295e-05, 'epoch': 0.7}
{'loss': 0.066, 'grad_norm': 0.09973162412643433, 'learning_rate': 1.5255658005029338e-05, 'epoch': 0.71}
{'loss': 0.0719, 'grad_norm': 0.21467217803001404, 'learning_rate': 1.5199776473875385e-05, 'epoch': 0.72}
{'loss': 0.0529, 'grad_norm': 1.227037787437439, 'learning_rate': 1.514389494272143e-05, 'epoch': 0.73}
{'loss': 0.0686, 'grad_norm': 1.6393033266067505, 'learning_rate': 1.5088013411567479e-05, 'epoch': 0.74}
{'loss': 0.0195, 'grad_norm': 0.20542636513710022, 'learning_rate': 1.5032131880413526e-05, 'epoch': 0.75}
{'loss': 0.0341, 'grad_norm': 0.9420952200889587, 'learning_rate': 1.4976250349259571e-05, 'epoch': 0.75}
{'loss': 0.0561, 'grad_norm': 1.2364208698272705, 'learning_rate': 1.4920368818105618e-05, 'epoch': 0.76}
{'loss': 0.0512, 'grad_norm': 0.24209430813789368, 'learning_rate': 1.4864487286951663e-05, 'epoch': 0.77}
{'loss': 0.0364, 'grad_norm': 0.3291429877281189, 'learning_rate': 1.480860575579771e-05, 'epoch': 0.78}
{'loss': 0.0543, 'grad_norm': 0.23653985559940338, 'learning_rate': 1.4752724224643757e-05, 'epoch': 0.79}
{'loss': 0.0211, 'grad_norm': 2.4951276779174805, 'learning_rate': 1.4696842693489804e-05, 'epoch': 0.8}
{'loss': 0.0667, 'grad_norm': 0.34933799505233765, 'learning_rate': 1.4640961162335849e-05, 'epoch': 0.8}
{'loss': 0.1054, 'grad_norm': 4.331930637359619, 'learning_rate': 1.4585079631181896e-05, 'epoch': 0.81}
{'loss': 0.0669, 'grad_norm': 0.4978809952735901, 'learning_rate': 1.4529198100027941e-05, 'epoch': 0.82}
{'loss': 0.0342, 'grad_norm': 1.0523930788040161, 'learning_rate': 1.4473316568873988e-05, 'epoch': 0.83}
{'loss': 0.0281, 'grad_norm': 2.8121769428253174, 'learning_rate': 1.4417435037720035e-05, 'epoch': 0.84}
{'loss': 0.048, 'grad_norm': 3.580766439437866, 'learning_rate': 1.4361553506566082e-05, 'epoch': 0.85}
{'loss': 0.0462, 'grad_norm': 2.154733180999756, 'learning_rate': 1.4305671975412127e-05, 'epoch': 0.85}
{'loss': 0.0197, 'grad_norm': 1.2103700637817383, 'learning_rate': 1.4249790444258174e-05, 'epoch': 0.86}
{'loss': 0.0318, 'grad_norm': 0.0725373774766922, 'learning_rate': 1.4193908913104219e-05, 'epoch': 0.87}
{'loss': 0.05, 'grad_norm': 1.619966983795166, 'learning_rate': 1.4138027381950266e-05, 'epoch': 0.88}
{'loss': 0.0315, 'grad_norm': 0.47154659032821655, 'learning_rate': 1.4082145850796315e-05, 'epoch': 0.89}
{'loss': 0.0467, 'grad_norm': 0.12767323851585388, 'learning_rate': 1.402626431964236e-05, 'epoch': 0.9}
{'loss': 0.0539, 'grad_norm': 2.252807855606079, 'learning_rate': 1.3970382788488405e-05, 'epoch': 0.91}
{'loss': 0.0554, 'grad_norm': 1.9516241550445557, 'learning_rate': 1.3914501257334452e-05, 'epoch': 0.91}
{'loss': 0.0217, 'grad_norm': 2.3825454711914062, 'learning_rate': 1.3858619726180497e-05, 'epoch': 0.92}
{'loss': 0.0739, 'grad_norm': 1.9452996253967285, 'learning_rate': 1.3802738195026544e-05, 'epoch': 0.93}
{'loss': 0.0941, 'grad_norm': 0.29107049107551575, 'learning_rate': 1.3746856663872593e-05, 'epoch': 0.94}
{'loss': 0.0454, 'grad_norm': 0.10492923855781555, 'learning_rate': 1.3690975132718638e-05, 'epoch': 0.95}
{'loss': 0.0513, 'grad_norm': 0.061541736125946045, 'learning_rate': 1.3635093601564685e-05, 'epoch': 0.96}
{'loss': 0.0618, 'grad_norm': 0.12474195659160614, 'learning_rate': 1.357921207041073e-05, 'epoch': 0.96}
{'loss': 0.0231, 'grad_norm': 0.3772042691707611, 'learning_rate': 1.3523330539256775e-05, 'epoch': 0.97}
{'loss': 0.0634, 'grad_norm': 1.200066089630127, 'learning_rate': 1.3467449008102824e-05, 'epoch': 0.98}
{'loss': 0.0584, 'grad_norm': 0.5622051358222961, 'learning_rate': 1.341156747694887e-05, 'epoch': 0.99}
{'loss': 0.0057, 'grad_norm': 0.18554089963436127, 'learning_rate': 1.3355685945794916e-05, 'epoch': 1.0}
{'eval_loss': 0.046351075172424316, 'eval_runtime': 6.6618, 'eval_samples_per_second': 358.012, 'eval_steps_per_second': 44.883, 'epoch': 1.0}
 33%|██████████████████████████████████████████████                                                                                            | 1193/3579 [01:52<03:32, 11.25it/s/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.0256, 'grad_norm': 0.46282967925071716, 'learning_rate': 1.3299804414640963e-05, 'epoch': 1.01}
{'loss': 0.0212, 'grad_norm': 0.05052436888217926, 'learning_rate': 1.3243922883487008e-05, 'epoch': 1.01}
{'loss': 0.0343, 'grad_norm': 0.06596551835536957, 'learning_rate': 1.3188041352333055e-05, 'epoch': 1.02}
{'loss': 0.0125, 'grad_norm': 0.061313942074775696, 'learning_rate': 1.3132159821179102e-05, 'epoch': 1.03}
{'loss': 0.0282, 'grad_norm': 1.406914234161377, 'learning_rate': 1.3076278290025149e-05, 'epoch': 1.04}
{'loss': 0.0206, 'grad_norm': 0.1778222769498825, 'learning_rate': 1.3020396758871194e-05, 'epoch': 1.05}
{'loss': 0.0162, 'grad_norm': 0.04519159346818924, 'learning_rate': 1.296451522771724e-05, 'epoch': 1.06}
{'loss': 0.0267, 'grad_norm': 0.07608918845653534, 'learning_rate': 1.2908633696563286e-05, 'epoch': 1.06}
{'loss': 0.0283, 'grad_norm': 1.2592483758926392, 'learning_rate': 1.2852752165409333e-05, 'epoch': 1.07}
{'loss': 0.0012, 'grad_norm': 0.13162536919116974, 'learning_rate': 1.279687063425538e-05, 'epoch': 1.08}
{'loss': 0.0408, 'grad_norm': 0.17509953677654266, 'learning_rate': 1.2740989103101427e-05, 'epoch': 1.09}
{'loss': 0.0616, 'grad_norm': 0.052215952426195145, 'learning_rate': 1.2685107571947472e-05, 'epoch': 1.1}
{'loss': 0.0294, 'grad_norm': 3.2709054946899414, 'learning_rate': 1.2629226040793519e-05, 'epoch': 1.11}
{'loss': 0.0334, 'grad_norm': 1.3246878385543823, 'learning_rate': 1.2573344509639564e-05, 'epoch': 1.11}
{'loss': 0.0286, 'grad_norm': 0.17724859714508057, 'learning_rate': 1.2517462978485611e-05, 'epoch': 1.12}
{'loss': 0.0486, 'grad_norm': 0.22485558688640594, 'learning_rate': 1.246158144733166e-05, 'epoch': 1.13}
{'loss': 0.0133, 'grad_norm': 0.5430116057395935, 'learning_rate': 1.2405699916177705e-05, 'epoch': 1.14}
{'loss': 0.0477, 'grad_norm': 0.05922402814030647, 'learning_rate': 1.234981838502375e-05, 'epoch': 1.15}
{'loss': 0.0125, 'grad_norm': 0.2672996520996094, 'learning_rate': 1.2293936853869797e-05, 'epoch': 1.16}
{'loss': 0.033, 'grad_norm': 2.7233569622039795, 'learning_rate': 1.2238055322715842e-05, 'epoch': 1.17}
{'loss': 0.0125, 'grad_norm': 1.526733160018921, 'learning_rate': 1.2182173791561889e-05, 'epoch': 1.17}
{'loss': 0.0352, 'grad_norm': 1.1550850868225098, 'learning_rate': 1.2126292260407938e-05, 'epoch': 1.18}
{'loss': 0.058, 'grad_norm': 0.23843051493167877, 'learning_rate': 1.2070410729253983e-05, 'epoch': 1.19}
{'loss': 0.0402, 'grad_norm': 1.1211442947387695, 'learning_rate': 1.201452919810003e-05, 'epoch': 1.2}
{'loss': 0.0403, 'grad_norm': 0.2678467929363251, 'learning_rate': 1.1958647666946075e-05, 'epoch': 1.21}
{'loss': 0.0276, 'grad_norm': 0.11906436830759048, 'learning_rate': 1.190276613579212e-05, 'epoch': 1.22}
{'loss': 0.0268, 'grad_norm': 0.5504626035690308, 'learning_rate': 1.1846884604638169e-05, 'epoch': 1.22}
{'loss': 0.0445, 'grad_norm': 7.424131393432617, 'learning_rate': 1.1791003073484216e-05, 'epoch': 1.23}
{'loss': 0.0372, 'grad_norm': 0.8708865642547607, 'learning_rate': 1.173512154233026e-05, 'epoch': 1.24}
{'loss': 0.0123, 'grad_norm': 0.058172471821308136, 'learning_rate': 1.1679240011176308e-05, 'epoch': 1.25}
{'loss': 0.0355, 'grad_norm': 0.08309406042098999, 'learning_rate': 1.1623358480022353e-05, 'epoch': 1.26}
{'loss': 0.0363, 'grad_norm': 0.12342749536037445, 'learning_rate': 1.15674769488684e-05, 'epoch': 1.27}
{'loss': 0.0201, 'grad_norm': 1.424614667892456, 'learning_rate': 1.1511595417714447e-05, 'epoch': 1.27}
{'loss': 0.0378, 'grad_norm': 1.8380707502365112, 'learning_rate': 1.1455713886560494e-05, 'epoch': 1.28}
{'loss': 0.051, 'grad_norm': 1.2214592695236206, 'learning_rate': 1.1399832355406539e-05, 'epoch': 1.29}
{'loss': 0.0462, 'grad_norm': 0.13436059653759003, 'learning_rate': 1.1343950824252586e-05, 'epoch': 1.3}
{'loss': 0.0133, 'grad_norm': 0.13016721606254578, 'learning_rate': 1.1288069293098631e-05, 'epoch': 1.31}
{'loss': 0.0253, 'grad_norm': 0.15635953843593597, 'learning_rate': 1.1232187761944678e-05, 'epoch': 1.32}
{'loss': 0.0361, 'grad_norm': 0.2136937528848648, 'learning_rate': 1.1176306230790725e-05, 'epoch': 1.32}
{'loss': 0.0208, 'grad_norm': 0.20978794991970062, 'learning_rate': 1.1120424699636772e-05, 'epoch': 1.33}
{'loss': 0.0202, 'grad_norm': 1.231779932975769, 'learning_rate': 1.1064543168482817e-05, 'epoch': 1.34}
{'loss': 0.0234, 'grad_norm': 0.06141538918018341, 'learning_rate': 1.1008661637328864e-05, 'epoch': 1.35}
{'loss': 0.0416, 'grad_norm': 0.18181876838207245, 'learning_rate': 1.0952780106174909e-05, 'epoch': 1.36}
{'loss': 0.0612, 'grad_norm': 1.6316416263580322, 'learning_rate': 1.0896898575020956e-05, 'epoch': 1.37}
{'loss': 0.0201, 'grad_norm': 0.7258625030517578, 'learning_rate': 1.0841017043867004e-05, 'epoch': 1.37}
{'loss': 0.0282, 'grad_norm': 0.9465862512588501, 'learning_rate': 1.078513551271305e-05, 'epoch': 1.38}
{'loss': 0.0426, 'grad_norm': 0.0356743186712265, 'learning_rate': 1.0729253981559097e-05, 'epoch': 1.39}
{'loss': 0.0293, 'grad_norm': 1.3083239793777466, 'learning_rate': 1.0673372450405142e-05, 'epoch': 1.4}
{'loss': 0.0258, 'grad_norm': 1.4160020351409912, 'learning_rate': 1.0617490919251187e-05, 'epoch': 1.41}
{'loss': 0.0165, 'grad_norm': 1.3075863122940063, 'learning_rate': 1.0561609388097234e-05, 'epoch': 1.42}
{'loss': 0.0337, 'grad_norm': 3.633251905441284, 'learning_rate': 1.0505727856943282e-05, 'epoch': 1.42}
{'loss': 0.0776, 'grad_norm': 0.23475413024425507, 'learning_rate': 1.0449846325789328e-05, 'epoch': 1.43}
{'loss': 0.0779, 'grad_norm': 0.31177613139152527, 'learning_rate': 1.0393964794635375e-05, 'epoch': 1.44}
{'loss': 0.0251, 'grad_norm': 0.3596649765968323, 'learning_rate': 1.033808326348142e-05, 'epoch': 1.45}
{'loss': 0.031, 'grad_norm': 1.170172929763794, 'learning_rate': 1.0282201732327467e-05, 'epoch': 1.46}
{'loss': 0.0436, 'grad_norm': 0.4291512072086334, 'learning_rate': 1.0226320201173514e-05, 'epoch': 1.47}
{'loss': 0.0433, 'grad_norm': 1.1653213500976562, 'learning_rate': 1.017043867001956e-05, 'epoch': 1.48}
{'loss': 0.0353, 'grad_norm': 1.2634847164154053, 'learning_rate': 1.0114557138865606e-05, 'epoch': 1.48}
{'loss': 0.0647, 'grad_norm': 4.695246696472168, 'learning_rate': 1.0058675607711653e-05, 'epoch': 1.49}
{'loss': 0.0519, 'grad_norm': 0.8663536310195923, 'learning_rate': 1.0002794076557698e-05, 'epoch': 1.5}
{'loss': 0.0565, 'grad_norm': 3.8677642345428467, 'learning_rate': 9.946912545403745e-06, 'epoch': 1.51}
{'loss': 0.0424, 'grad_norm': 1.6964359283447266, 'learning_rate': 9.891031014249792e-06, 'epoch': 1.52}
{'loss': 0.0463, 'grad_norm': 0.7262023091316223, 'learning_rate': 9.835149483095837e-06, 'epoch': 1.53}
{'loss': 0.0207, 'grad_norm': 0.3482843339443207, 'learning_rate': 9.779267951941884e-06, 'epoch': 1.53}
{'loss': 0.0485, 'grad_norm': 1.2473279237747192, 'learning_rate': 9.72338642078793e-06, 'epoch': 1.54}
{'loss': 0.0294, 'grad_norm': 0.42349761724472046, 'learning_rate': 9.667504889633976e-06, 'epoch': 1.55}
{'loss': 0.0476, 'grad_norm': 6.203632831573486, 'learning_rate': 9.611623358480023e-06, 'epoch': 1.56}
{'loss': 0.0291, 'grad_norm': 1.5418747663497925, 'learning_rate': 9.55574182732607e-06, 'epoch': 1.57}
{'loss': 0.0072, 'grad_norm': 3.422119379043579, 'learning_rate': 9.499860296172115e-06, 'epoch': 1.58}
{'loss': 0.0152, 'grad_norm': 0.09284735471010208, 'learning_rate': 9.443978765018162e-06, 'epoch': 1.58}
{'loss': 0.0337, 'grad_norm': 0.1402541697025299, 'learning_rate': 9.388097233864209e-06, 'epoch': 1.59}
{'loss': 0.0297, 'grad_norm': 0.04214239865541458, 'learning_rate': 9.332215702710256e-06, 'epoch': 1.6}
{'loss': 0.0214, 'grad_norm': 3.482706069946289, 'learning_rate': 9.2763341715563e-06, 'epoch': 1.61}
{'loss': 0.0714, 'grad_norm': 3.537844181060791, 'learning_rate': 9.220452640402348e-06, 'epoch': 1.62}
{'loss': 0.0341, 'grad_norm': 0.13287042081356049, 'learning_rate': 9.164571109248395e-06, 'epoch': 1.63}
{'loss': 0.0349, 'grad_norm': 1.7027833461761475, 'learning_rate': 9.108689578094441e-06, 'epoch': 1.63}
{'loss': 0.0583, 'grad_norm': 1.9074068069458008, 'learning_rate': 9.052808046940487e-06, 'epoch': 1.64}
{'loss': 0.0023, 'grad_norm': 0.06331072002649307, 'learning_rate': 8.996926515786534e-06, 'epoch': 1.65}
{'loss': 0.0251, 'grad_norm': 0.3382226824760437, 'learning_rate': 8.94104498463258e-06, 'epoch': 1.66}
{'loss': 0.0476, 'grad_norm': 0.1651848703622818, 'learning_rate': 8.885163453478626e-06, 'epoch': 1.67}
{'loss': 0.0165, 'grad_norm': 0.05846475064754486, 'learning_rate': 8.829281922324673e-06, 'epoch': 1.68}
{'loss': 0.0243, 'grad_norm': 0.08631427586078644, 'learning_rate': 8.77340039117072e-06, 'epoch': 1.68}
{'loss': 0.0219, 'grad_norm': 1.4457944631576538, 'learning_rate': 8.717518860016765e-06, 'epoch': 1.69}
{'loss': 0.0835, 'grad_norm': 1.1073887348175049, 'learning_rate': 8.661637328862812e-06, 'epoch': 1.7}
{'loss': 0.0396, 'grad_norm': 0.3289307653903961, 'learning_rate': 8.605755797708858e-06, 'epoch': 1.71}
{'loss': 0.018, 'grad_norm': 0.07395895570516586, 'learning_rate': 8.549874266554904e-06, 'epoch': 1.72}
{'loss': 0.0283, 'grad_norm': 0.21938955783843994, 'learning_rate': 8.49399273540095e-06, 'epoch': 1.73}
{'loss': 0.032, 'grad_norm': 1.460564374923706, 'learning_rate': 8.438111204246997e-06, 'epoch': 1.74}
{'loss': 0.0049, 'grad_norm': 0.8149283528327942, 'learning_rate': 8.382229673093043e-06, 'epoch': 1.74}
{'loss': 0.0302, 'grad_norm': 0.15585054457187653, 'learning_rate': 8.32634814193909e-06, 'epoch': 1.75}
{'loss': 0.0417, 'grad_norm': 0.13021229207515717, 'learning_rate': 8.270466610785136e-06, 'epoch': 1.76}
{'loss': 0.0208, 'grad_norm': 0.13750848174095154, 'learning_rate': 8.214585079631182e-06, 'epoch': 1.77}
{'loss': 0.0128, 'grad_norm': 0.06260751932859421, 'learning_rate': 8.158703548477229e-06, 'epoch': 1.78}
{'loss': 0.0303, 'grad_norm': 0.05218108743429184, 'learning_rate': 8.102822017323276e-06, 'epoch': 1.79}
{'loss': 0.0838, 'grad_norm': 2.884417772293091, 'learning_rate': 8.04694048616932e-06, 'epoch': 1.79}
{'loss': 0.0199, 'grad_norm': 0.047485172748565674, 'learning_rate': 7.991058955015368e-06, 'epoch': 1.8}
{'loss': 0.0434, 'grad_norm': 0.9449493885040283, 'learning_rate': 7.935177423861415e-06, 'epoch': 1.81}
{'loss': 0.0123, 'grad_norm': 0.28820738196372986, 'learning_rate': 7.87929589270746e-06, 'epoch': 1.82}
{'loss': 0.0021, 'grad_norm': 0.11419212818145752, 'learning_rate': 7.823414361553507e-06, 'epoch': 1.83}
{'loss': 0.041, 'grad_norm': 0.9341109395027161, 'learning_rate': 7.767532830399554e-06, 'epoch': 1.84}
{'loss': 0.0338, 'grad_norm': 0.1356273889541626, 'learning_rate': 7.711651299245599e-06, 'epoch': 1.84}
{'loss': 0.017, 'grad_norm': 0.20489239692687988, 'learning_rate': 7.655769768091647e-06, 'epoch': 1.85}
{'loss': 0.0138, 'grad_norm': 0.15186043083667755, 'learning_rate': 7.5998882369376925e-06, 'epoch': 1.86}
{'loss': 0.0233, 'grad_norm': 0.07466195523738861, 'learning_rate': 7.5440067057837394e-06, 'epoch': 1.87}
{'loss': 0.0383, 'grad_norm': 1.8267993927001953, 'learning_rate': 7.4881251746297855e-06, 'epoch': 1.88}
{'loss': 0.0265, 'grad_norm': 0.2596760392189026, 'learning_rate': 7.4322436434758315e-06, 'epoch': 1.89}
{'loss': 0.0526, 'grad_norm': 0.866472601890564, 'learning_rate': 7.3763621123218785e-06, 'epoch': 1.89}
{'loss': 0.0153, 'grad_norm': 0.23332978785037994, 'learning_rate': 7.3204805811679245e-06, 'epoch': 1.9}
{'loss': 0.0605, 'grad_norm': 1.5751094818115234, 'learning_rate': 7.2645990500139706e-06, 'epoch': 1.91}
{'loss': 0.0382, 'grad_norm': 0.06922368705272675, 'learning_rate': 7.2087175188600175e-06, 'epoch': 1.92}
{'loss': 0.0334, 'grad_norm': 1.2380610704421997, 'learning_rate': 7.1528359877060635e-06, 'epoch': 1.93}
{'loss': 0.0231, 'grad_norm': 2.399585247039795, 'learning_rate': 7.0969544565521096e-06, 'epoch': 1.94}
{'loss': 0.0466, 'grad_norm': 1.8481136560440063, 'learning_rate': 7.041072925398157e-06, 'epoch': 1.94}
{'loss': 0.0033, 'grad_norm': 0.22745363414287567, 'learning_rate': 6.9851913942442025e-06, 'epoch': 1.95}
{'loss': 0.0075, 'grad_norm': 2.084543466567993, 'learning_rate': 6.929309863090249e-06, 'epoch': 1.96}
{'loss': 0.0116, 'grad_norm': 0.04386327788233757, 'learning_rate': 6.873428331936296e-06, 'epoch': 1.97}
{'loss': 0.016, 'grad_norm': 0.042715948075056076, 'learning_rate': 6.817546800782342e-06, 'epoch': 1.98}
{'loss': 0.0437, 'grad_norm': 0.4765121042728424, 'learning_rate': 6.761665269628388e-06, 'epoch': 1.99}
{'loss': 0.0237, 'grad_norm': 1.3193302154541016, 'learning_rate': 6.705783738474435e-06, 'epoch': 1.99}
{'eval_loss': 0.040094200521707535, 'eval_runtime': 6.6432, 'eval_samples_per_second': 359.014, 'eval_steps_per_second': 45.008, 'epoch': 2.0}
 67%|████████████████████████████████████████████████████████████████████████████████████████████                                              | 2386/3579 [03:46<01:40, 11.89it/s/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
{'loss': 0.0446, 'grad_norm': 0.8816196918487549, 'learning_rate': 6.649902207320481e-06, 'epoch': 2.0}
{'loss': 0.0182, 'grad_norm': 1.4349145889282227, 'learning_rate': 6.5940206761665274e-06, 'epoch': 2.01}
{'loss': 0.0052, 'grad_norm': 0.7007184028625488, 'learning_rate': 6.538139145012574e-06, 'epoch': 2.02}
{'loss': 0.0185, 'grad_norm': 0.1780274361371994, 'learning_rate': 6.48225761385862e-06, 'epoch': 2.03}
{'loss': 0.0184, 'grad_norm': 0.18851636350154877, 'learning_rate': 6.4263760827046665e-06, 'epoch': 2.04}
{'loss': 0.0304, 'grad_norm': 1.1726155281066895, 'learning_rate': 6.370494551550713e-06, 'epoch': 2.05}
{'loss': 0.0137, 'grad_norm': 0.11769409477710724, 'learning_rate': 6.314613020396759e-06, 'epoch': 2.05}
{'loss': 0.0482, 'grad_norm': 3.3222551345825195, 'learning_rate': 6.2587314892428055e-06, 'epoch': 2.06}
{'loss': 0.0162, 'grad_norm': 0.04280824214220047, 'learning_rate': 6.202849958088852e-06, 'epoch': 2.07}
{'loss': 0.0176, 'grad_norm': 1.5648442506790161, 'learning_rate': 6.1469684269348984e-06, 'epoch': 2.08}
{'loss': 0.0276, 'grad_norm': 1.37586510181427, 'learning_rate': 6.0910868957809445e-06, 'epoch': 2.09}
{'loss': 0.0352, 'grad_norm': 0.07418563961982727, 'learning_rate': 6.035205364626991e-06, 'epoch': 2.1}
{'loss': 0.0338, 'grad_norm': 1.6218510866165161, 'learning_rate': 5.9793238334730374e-06, 'epoch': 2.1}
{'loss': 0.0152, 'grad_norm': 1.6213799715042114, 'learning_rate': 5.923442302319084e-06, 'epoch': 2.11}
{'loss': 0.0155, 'grad_norm': 0.432101845741272, 'learning_rate': 5.86756077116513e-06, 'epoch': 2.12}
{'loss': 0.0029, 'grad_norm': 0.11987204104661942, 'learning_rate': 5.8116792400111764e-06, 'epoch': 2.13}
{'loss': 0.0058, 'grad_norm': 0.1267407089471817, 'learning_rate': 5.755797708857223e-06, 'epoch': 2.14}
{'loss': 0.001, 'grad_norm': 0.2986673414707184, 'learning_rate': 5.699916177703269e-06, 'epoch': 2.15}
{'loss': 0.0016, 'grad_norm': 0.18818017840385437, 'learning_rate': 5.6440346465493155e-06, 'epoch': 2.15}
{'loss': 0.0014, 'grad_norm': 0.22404338419437408, 'learning_rate': 5.588153115395362e-06, 'epoch': 2.16}
{'loss': 0.0124, 'grad_norm': 0.19948972761631012, 'learning_rate': 5.532271584241408e-06, 'epoch': 2.17}
{'loss': 0.023, 'grad_norm': 0.22437068819999695, 'learning_rate': 5.4763900530874545e-06, 'epoch': 2.18}
{'loss': 0.0145, 'grad_norm': 0.06240870803594589, 'learning_rate': 5.420508521933502e-06, 'epoch': 2.19}
{'loss': 0.0422, 'grad_norm': 0.06759006530046463, 'learning_rate': 5.364626990779548e-06, 'epoch': 2.2}
{'loss': 0.0183, 'grad_norm': 0.20334309339523315, 'learning_rate': 5.3087454596255935e-06, 'epoch': 2.2}
{'loss': 0.034, 'grad_norm': 1.3151670694351196, 'learning_rate': 5.252863928471641e-06, 'epoch': 2.21}
{'loss': 0.015, 'grad_norm': 4.4116950035095215, 'learning_rate': 5.196982397317687e-06, 'epoch': 2.22}
{'loss': 0.0272, 'grad_norm': 0.44920822978019714, 'learning_rate': 5.141100866163733e-06, 'epoch': 2.23}
{'loss': 0.0342, 'grad_norm': 0.188993439078331, 'learning_rate': 5.08521933500978e-06, 'epoch': 2.24}
{'loss': 0.0108, 'grad_norm': 1.8877558708190918, 'learning_rate': 5.029337803855826e-06, 'epoch': 2.25}
{'loss': 0.0067, 'grad_norm': 1.223881721496582, 'learning_rate': 4.973456272701872e-06, 'epoch': 2.25}
{'loss': 0.0175, 'grad_norm': 0.3618568778038025, 'learning_rate': 4.917574741547918e-06, 'epoch': 2.26}
{'loss': 0.0155, 'grad_norm': 0.05392254516482353, 'learning_rate': 4.861693210393965e-06, 'epoch': 2.27}
{'loss': 0.0087, 'grad_norm': 0.3749074339866638, 'learning_rate': 4.805811679240011e-06, 'epoch': 2.28}
{'loss': 0.0238, 'grad_norm': 0.4079096019268036, 'learning_rate': 4.749930148086057e-06, 'epoch': 2.29}
{'loss': 0.0341, 'grad_norm': 0.08159175515174866, 'learning_rate': 4.694048616932104e-06, 'epoch': 2.3}
{'loss': 0.0164, 'grad_norm': 0.06608247011899948, 'learning_rate': 4.63816708577815e-06, 'epoch': 2.31}
{'loss': 0.0224, 'grad_norm': 0.5995359420776367, 'learning_rate': 4.582285554624197e-06, 'epoch': 2.31}
{'loss': 0.0189, 'grad_norm': 0.09071900695562363, 'learning_rate': 4.526404023470243e-06, 'epoch': 2.32}
{'loss': 0.0191, 'grad_norm': 2.7062740325927734, 'learning_rate': 4.47052249231629e-06, 'epoch': 2.33}
{'loss': 0.0225, 'grad_norm': 1.3003032207489014, 'learning_rate': 4.414640961162336e-06, 'epoch': 2.34}
{'loss': 0.0036, 'grad_norm': 0.7237021923065186, 'learning_rate': 4.358759430008382e-06, 'epoch': 2.35}
{'loss': 0.0312, 'grad_norm': 5.645013809204102, 'learning_rate': 4.302877898854429e-06, 'epoch': 2.36}
{'loss': 0.0181, 'grad_norm': 0.15913625061511993, 'learning_rate': 4.246996367700475e-06, 'epoch': 2.36}
{'loss': 0.0037, 'grad_norm': 3.0632784366607666, 'learning_rate': 4.191114836546521e-06, 'epoch': 2.37}
{'loss': 0.0031, 'grad_norm': 0.12201289087533951, 'learning_rate': 4.135233305392568e-06, 'epoch': 2.38}
{'loss': 0.0406, 'grad_norm': 4.159486293792725, 'learning_rate': 4.079351774238614e-06, 'epoch': 2.39}
{'loss': 0.0088, 'grad_norm': 1.5210199356079102, 'learning_rate': 4.02347024308466e-06, 'epoch': 2.4}
{'loss': 0.0139, 'grad_norm': 0.11164053529500961, 'learning_rate': 3.967588711930707e-06, 'epoch': 2.41}
{'loss': 0.0095, 'grad_norm': 0.025470132008194923, 'learning_rate': 3.911707180776753e-06, 'epoch': 2.41}
{'loss': 0.008, 'grad_norm': 0.31606119871139526, 'learning_rate': 3.855825649622799e-06, 'epoch': 2.42}
{'loss': 0.01, 'grad_norm': 1.954861044883728, 'learning_rate': 3.7999441184688463e-06, 'epoch': 2.43}
{'loss': 0.051, 'grad_norm': 0.04874233156442642, 'learning_rate': 3.7440625873148927e-06, 'epoch': 2.44}
{'loss': 0.0213, 'grad_norm': 0.11671678721904755, 'learning_rate': 3.6881810561609392e-06, 'epoch': 2.45}
{'loss': 0.0273, 'grad_norm': 1.9131489992141724, 'learning_rate': 3.6322995250069853e-06, 'epoch': 2.46}
{'loss': 0.0109, 'grad_norm': 3.908717393875122, 'learning_rate': 3.5764179938530318e-06, 'epoch': 2.46}
{'loss': 0.0139, 'grad_norm': 0.053231000900268555, 'learning_rate': 3.5205364626990787e-06, 'epoch': 2.47}
{'loss': 0.0375, 'grad_norm': 1.4605549573898315, 'learning_rate': 3.4646549315451243e-06, 'epoch': 2.48}
{'loss': 0.0009, 'grad_norm': 0.03607641160488129, 'learning_rate': 3.408773400391171e-06, 'epoch': 2.49}
{'loss': 0.0014, 'grad_norm': 0.06069992110133171, 'learning_rate': 3.3528918692372177e-06, 'epoch': 2.5}
{'loss': 0.0131, 'grad_norm': 0.48118552565574646, 'learning_rate': 3.2970103380832637e-06, 'epoch': 2.51}
{'loss': 0.036, 'grad_norm': 0.5967288017272949, 'learning_rate': 3.24112880692931e-06, 'epoch': 2.51}
{'loss': 0.0352, 'grad_norm': 1.8237863779067993, 'learning_rate': 3.1852472757753567e-06, 'epoch': 2.52}
{'loss': 0.0223, 'grad_norm': 0.07417386025190353, 'learning_rate': 3.1293657446214027e-06, 'epoch': 2.53}
{'loss': 0.0359, 'grad_norm': 6.0285539627075195, 'learning_rate': 3.0734842134674492e-06, 'epoch': 2.54}
{'loss': 0.0081, 'grad_norm': 0.06540422141551971, 'learning_rate': 3.0176026823134957e-06, 'epoch': 2.55}
{'loss': 0.0176, 'grad_norm': 1.0968444347381592, 'learning_rate': 2.961721151159542e-06, 'epoch': 2.56}
{'loss': 0.0124, 'grad_norm': 0.19896452128887177, 'learning_rate': 2.9058396200055882e-06, 'epoch': 2.56}
{'loss': 0.0358, 'grad_norm': 1.6797977685928345, 'learning_rate': 2.8499580888516347e-06, 'epoch': 2.57}
{'loss': 0.0345, 'grad_norm': 4.6243109703063965, 'learning_rate': 2.794076557697681e-06, 'epoch': 2.58}
{'loss': 0.0456, 'grad_norm': 1.2213046550750732, 'learning_rate': 2.7381950265437272e-06, 'epoch': 2.59}
{'loss': 0.0262, 'grad_norm': 0.08156823366880417, 'learning_rate': 2.682313495389774e-06, 'epoch': 2.6}
{'loss': 0.0105, 'grad_norm': 0.29801109433174133, 'learning_rate': 2.6264319642358206e-06, 'epoch': 2.61}
{'loss': 0.0239, 'grad_norm': 0.05568576231598854, 'learning_rate': 2.5705504330818667e-06, 'epoch': 2.62}
{'loss': 0.0146, 'grad_norm': 6.995665550231934, 'learning_rate': 2.514668901927913e-06, 'epoch': 2.62}
{'loss': 0.0079, 'grad_norm': 0.04691368341445923, 'learning_rate': 2.458787370773959e-06, 'epoch': 2.63}
{'loss': 0.0139, 'grad_norm': 0.1830323487520218, 'learning_rate': 2.4029058396200057e-06, 'epoch': 2.64}
{'loss': 0.0033, 'grad_norm': 0.07081541419029236, 'learning_rate': 2.347024308466052e-06, 'epoch': 2.65}
{'loss': 0.0146, 'grad_norm': 0.04056893289089203, 'learning_rate': 2.2911427773120986e-06, 'epoch': 2.66}
{'loss': 0.0182, 'grad_norm': 0.06823933124542236, 'learning_rate': 2.235261246158145e-06, 'epoch': 2.67}
{'loss': 0.016, 'grad_norm': 0.06007245555520058, 'learning_rate': 2.179379715004191e-06, 'epoch': 2.67}
{'loss': 0.0216, 'grad_norm': 0.058750659227371216, 'learning_rate': 2.1234981838502376e-06, 'epoch': 2.68}
{'loss': 0.0355, 'grad_norm': 1.8356342315673828, 'learning_rate': 2.067616652696284e-06, 'epoch': 2.69}
{'loss': 0.0415, 'grad_norm': 0.03324500098824501, 'learning_rate': 2.01173512154233e-06, 'epoch': 2.7}
{'loss': 0.0107, 'grad_norm': 2.6979360580444336, 'learning_rate': 1.9558535903883767e-06, 'epoch': 2.71}
{'loss': 0.0109, 'grad_norm': 0.7123364210128784, 'learning_rate': 1.8999720592344231e-06, 'epoch': 2.72}
{'loss': 0.026, 'grad_norm': 0.04762363061308861, 'learning_rate': 1.8440905280804696e-06, 'epoch': 2.72}
{'loss': 0.0165, 'grad_norm': 1.9316335916519165, 'learning_rate': 1.7882089969265159e-06, 'epoch': 2.73}
{'loss': 0.0119, 'grad_norm': 0.29621121287345886, 'learning_rate': 1.7323274657725621e-06, 'epoch': 2.74}
{'loss': 0.0218, 'grad_norm': 0.426044762134552, 'learning_rate': 1.6764459346186088e-06, 'epoch': 2.75}
{'loss': 0.0226, 'grad_norm': 3.616191864013672, 'learning_rate': 1.620564403464655e-06, 'epoch': 2.76}
{'loss': 0.0129, 'grad_norm': 0.9029086828231812, 'learning_rate': 1.5646828723107014e-06, 'epoch': 2.77}
{'loss': 0.0153, 'grad_norm': 0.10587393492460251, 'learning_rate': 1.5088013411567478e-06, 'epoch': 2.77}
{'loss': 0.0217, 'grad_norm': 0.09485606849193573, 'learning_rate': 1.4529198100027941e-06, 'epoch': 2.78}
{'loss': 0.0143, 'grad_norm': 2.28338360786438, 'learning_rate': 1.3970382788488406e-06, 'epoch': 2.79}
{'loss': 0.0175, 'grad_norm': 0.13992105424404144, 'learning_rate': 1.341156747694887e-06, 'epoch': 2.8}
{'loss': 0.016, 'grad_norm': 0.46927502751350403, 'learning_rate': 1.2852752165409333e-06, 'epoch': 2.81}
{'loss': 0.0089, 'grad_norm': 0.9315361380577087, 'learning_rate': 1.2293936853869796e-06, 'epoch': 2.82}
{'loss': 0.0394, 'grad_norm': 4.966811656951904, 'learning_rate': 1.173512154233026e-06, 'epoch': 2.82}
{'loss': 0.021, 'grad_norm': 0.1146150678396225, 'learning_rate': 1.1176306230790726e-06, 'epoch': 2.83}
{'loss': 0.0129, 'grad_norm': 0.5323796272277832, 'learning_rate': 1.0617490919251188e-06, 'epoch': 2.84}
{'loss': 0.039, 'grad_norm': 0.08891845494508743, 'learning_rate': 1.005867560771165e-06, 'epoch': 2.85}
{'loss': 0.0305, 'grad_norm': 1.358640432357788, 'learning_rate': 9.499860296172116e-07, 'epoch': 2.86}
{'loss': 0.0165, 'grad_norm': 0.3078041970729828, 'learning_rate': 8.941044984632579e-07, 'epoch': 2.87}
{'loss': 0.0178, 'grad_norm': 0.47895827889442444, 'learning_rate': 8.382229673093044e-07, 'epoch': 2.88}
{'loss': 0.0016, 'grad_norm': 0.06560589373111725, 'learning_rate': 7.823414361553507e-07, 'epoch': 2.88}
{'loss': 0.0178, 'grad_norm': 3.311647415161133, 'learning_rate': 7.264599050013971e-07, 'epoch': 2.89}
{'loss': 0.0224, 'grad_norm': 2.812727689743042, 'learning_rate': 6.705783738474435e-07, 'epoch': 2.9}
{'loss': 0.0019, 'grad_norm': 0.08662005513906479, 'learning_rate': 6.146968426934898e-07, 'epoch': 2.91}
{'loss': 0.0156, 'grad_norm': 0.1760588437318802, 'learning_rate': 5.588153115395363e-07, 'epoch': 2.92}
{'loss': 0.0014, 'grad_norm': 0.021631529554724693, 'learning_rate': 5.029337803855825e-07, 'epoch': 2.93}
{'loss': 0.0116, 'grad_norm': 0.030748890712857246, 'learning_rate': 4.4705224923162897e-07, 'epoch': 2.93}
{'loss': 0.0055, 'grad_norm': 0.13582037389278412, 'learning_rate': 3.9117071807767534e-07, 'epoch': 2.94}
{'loss': 0.0236, 'grad_norm': 1.358038306236267, 'learning_rate': 3.3528918692372177e-07, 'epoch': 2.95}
{'loss': 0.0113, 'grad_norm': 3.8444924354553223, 'learning_rate': 2.7940765576976814e-07, 'epoch': 2.96}
{'loss': 0.0147, 'grad_norm': 0.7563578486442566, 'learning_rate': 2.2352612461581448e-07, 'epoch': 2.97}
{'loss': 0.0029, 'grad_norm': 0.5255964994430542, 'learning_rate': 1.6764459346186088e-07, 'epoch': 2.98}
{'loss': 0.0128, 'grad_norm': 1.172229528427124, 'learning_rate': 1.1176306230790724e-07, 'epoch': 2.98}
{'loss': 0.0008, 'grad_norm': 0.08223295956850052, 'learning_rate': 5.588153115395362e-08, 'epoch': 2.99}
{'eval_loss': 0.04074491932988167, 'eval_runtime': 6.6816, 'eval_samples_per_second': 356.949, 'eval_steps_per_second': 44.75, 'epoch': 3.0}
{'train_runtime': 343.928, 'train_samples_per_second': 83.198, 'train_steps_per_second': 10.406, 'train_loss': 0.03345707721176049, 'epoch': 3.0}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3579/3579 [05:43<00:00, 10.41it/s]
2025-04-30 00:19:27,086 - INFO - Saving trained models
2025-04-30 00:19:27,371 - INFO - Evaluating Three-class Sentiment model...
/Users/jake/Developer/git-repos/cs541-final-project/01-model-priyanka/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 299/299 [00:06<00:00, 46.03it/s]
2025-04-30 00:19:33,876 - INFO - Three-class model evaluation results: {'eval_loss': 0.15171200037002563, 'eval_runtime': 6.5031, 'eval_samples_per_second': 366.747, 'eval_steps_per_second': 45.978, 'epoch': 3.0}
2025-04-30 00:19:33,876 - INFO - Evaluating Gradient-style Sentiment model...
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 299/299 [00:06<00:00, 43.86it/s]
2025-04-30 00:19:40,703 - INFO - Gradient model evaluation results: {'eval_loss': 0.040094200521707535, 'eval_runtime': 6.8255, 'eval_samples_per_second': 349.423, 'eval_steps_per_second': 43.806, 'epoch': 3.0}
2025-04-30 00:19:40,703 - INFO - Making example predictions
2025-04-30 00:19:40,704 - INFO - Three-class Sentiment predictions:
2025-04-30 00:19:40,820 - INFO - Raw logits: [[-2.6098957   4.798298   -2.8293746 ]
 [-3.7249496   4.568588   -1.307018  ]
 [-3.232985    5.1984735  -2.3773046 ]
 [-3.3897736   2.8981655  -0.06347322]
 [-3.4436727   4.769639   -1.7084163 ]]
2025-04-30 00:19:40,820 - INFO - Class predictions: [1 1 1 1 1]
2025-04-30 00:19:40,820 - INFO - Gradient-style Sentiment predictions:
2025-04-30 00:19:40,926 - INFO - Sentiment scores: [-0.00039522  0.00983916 -0.00114375  0.05180101  0.01187302]
2025-04-30 00:19:40,926 - INFO - Model training completed successfully
